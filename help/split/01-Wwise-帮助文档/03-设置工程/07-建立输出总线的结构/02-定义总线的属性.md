# 定义总线的属性

[Wwise 帮助文档](../../00-Wwise-帮助文档.md) > [设置工程](../00-设置工程.md) > [建立输出总线的结构](00-建立输出总线的结构.md) > 定义总线的属性

## 定义总线的属性

您可以使用总线属性来对游戏中的音频或振动进行全局更改。在定义总线属性时，您可以执行以下操作：

- [“通过现有声音生成振动效果”一节](../../05-使用声音和振动来提升游戏体验/05-管理-Motion/03-为游戏创建振动效果/01-通过现有声音生成振动效果.md "通过现有声音生成振动效果")

由于总线是控制的最后一级，所以您所做的更改都将影响其下方整组对象。

与对象一样，您也可以向总线上添加效果器、使用 RTPC、指派状态以及设置高级属性。有关详细信息，请参阅以下几节：

- [“将 Effect ShareSet 应用于 Wwise 对象”一节](../../05-使用声音和振动来提升游戏体验/04-管理效果器/00-管理效果器.md#applying_an_effect_shareset_to_an_object "将 Effect ShareSet 应用于 Wwise 对象")
- [“使用 Game Parameter 控制属性值”一节](../../04-与游戏互动/05-使用-RTPC/03-使用-Game-Parameter-控制属性值/00-使用-Game-Parameter-控制属性值.md "使用 Game Parameter 控制属性值")
- [“将 State 指派给对象和总线”一节](../../04-与游戏互动/03-使用-State/03-将-State-指派给对象和总线/00-将-State-指派给对象和总线.md "将 State 指派给对象和总线")
- [*管理优先级*](../../05-使用声音和振动来提升游戏体验/03-管理优先级/00-管理优先级.md "管理优先级")

### 定义总线的相对属性

您可为层级结构中的各条总线定义相对属性。相对属性是累积的，也就是说，总线的属性值会累加到其下的子对象中。

以下是您可以为总线修改的相对属性：

- **Bus Volume** —— 总线音量。用于直接调整总线的音量大小。
- **Voice Volume**（声部音量）– 总线中正在播放的音频对象所应用的衰减。
- **Voice Pitch**（声部音高）– 总线中正在播放的音频对象的播放速度。

您可以在 Multi Editor（多项编辑器）中同时为多条总线编辑这些属性。从 Project Explorer 的 Audio 选项卡中以及从快捷菜单中选择多条总线，选择 **Show in Multi Editor**。在连接到游戏的同时，您还可以实时微调这些属性。

**定义总线的相对属性的方法如下：**

1. 将一条总线加载到 Property Editor。
2. 键入一个值或拖动相应滑杆来为其中一个相对属性设置一个值：

   |  |  |
   | --- | --- |
   | [备注] | 备注 |
   | 不得在连通音乐对象的总线上操作音高属性。音频总线中对音高所做的更改不会影响音乐对象。 |

### 闪避信号

在游戏中的有些时间点，需要突显某些音频信号。对此，我们可以通过闪避来完成这一操作：自动降低发送到一条或多条总线的对象的音量来突显另一总线的信号。比如，当角色正在说话的时候，会降低背景音乐的音量。当角色停止说话的时候，会恢复背景音乐的音量。

在接下来的时间线中，在当前总线播放声音时，其他总线将根据 Fade Out（淡出）和 Volume（音量）参数淡出。在当前总线的声音结束时，过了 Recovery time（恢复时间），接着再 Fade In（淡入）。

|  |
| --- |
|  |

|  |  |
| --- | --- |
| [备注] | 备注 |
| 除了自动闪避，我们还可以通过 Meter 效果器插件来实施旁链压缩。藉此，根据源总线的电平动态调节目标总线的电平。跟自动闪避相比，这样可以进行更便捷的控制：只要当前总线上有声音，无论声音的电平是多少，都会按预定设置降低被闪避总线的音量。有关详细信息，请参阅[“Using RTPCs to fine-tune the audio mix”一节](../../04-与游戏互动/05-使用-RTPC/08-Using-RTPCs-to-fine-tune-the-audio-mix.md "Using RTPCs to fine-tune the audio mix")和 [“Meter”一节](../../10-Wwise-插件/04-效果器插件/12-Meter.md "Meter")。 |

**闪避总线：**

1. 将一条总线加载到 Property Editor。这条是当前总线。它会导致其他总线被*闪避*或被降低音量。不过，闪避不适用于 Auxiliary Bus（辅助总线）。
2. 在 **Auto-ducking**（自动闪避）选项卡中，单击 **Insert...**（插入...）。
3. 在打开的 Project Explorer - Browser（工程资源管理器 - 浏览器）中，选中要在当前总线接收信号时闪避的总线。总线无法要求自己或其直接父总线闪避。
4. 单击 **OK**（确定）来将选定总线添加到窗格中。
5. 为总线设置属性：

   - **Volume**（音量）：决定要在当前总线接收信号时将被闪避总线的音量降低多少。
   - **Fade Out**（淡出）：决定从原始音量淡出到闪避音量需要多长时间。
   - **Fade In**（淡入）：决定淡入并恢复到原始音量需要多长时间。
   - **Curve**（曲线）：决定要使用哪种曲线形状来定义淡出和淡入。
6. 设置窗格中所有总线的共有属性：

   - **Recovery time**（恢复时间）：决定从当前总线信号终止到被闪避信号开始淡入需要多长时间。
   - **Maximum ducking volume**（最大闪避音量）：决定当前总线最多可将窗格中所列总线的音量降低多少。

### 将音乐替换为玩家自己的音乐

Xbox One、Xbox Series X、PlayStation 4、PlayStation 5、iOS 和 Android 平台允许游戏玩家将游戏音乐替换为自己的音乐。对于所有平台，用户音乐播放时，您必须为要静音的所有总线启用 **Mute for Background Music** 选项。可以选择多条总线，这对音乐总线而言没有限制。

**将总线指派给平台的背景音乐选项：**

1. 将音频总线加载到 Property Editor。
2. 选择 **Mute for background music** 选项。

   现在，在用户通过游戏机上的音乐播放器播放音乐时，此总线将会静音。

平台不同，Mute for background music 的行为会稍稍有点不同。而且，在初始化声音引擎时，需要进行额外编程

- **Android**：Mute／Unmute（静音/取消静音）操作将仅在用户从音乐播放器应用程序切换至游戏时才会出现。也就是说，如果用户音乐自己结束播放了，那么就无需“Unmute”。
- **iOS**：如果在声音引擎初始化设置中设置了 AudioSession 标志（flag）“MixOther”，则 只有在用户从音乐播放器应用程序切换至游戏时才会做 Mute／Unmute 操作。也就是说，如果用户音乐自己结束播放了，那么就无需“Unmute”。在 iOS 8 和更高版本中，如果使用的是 AVAudioSessionCategoryAmbient 类别，则出现任何应用程序的音频中断时，游戏音乐都会发生静音和取消静音。
- **Xbox One、Xbox Series X、PlayStation 4 和 PlayStation 5**：某些平台具有 DVR 功能，可让游戏玩家录制并发布其游戏过程。这会带来一些法律问题，其中涉及到游戏音频当中受版权保护的音乐或用户可替换音乐。虽然游戏工作室有权在其游戏中使用所述音乐，但最终用户可能无权以任何形式对其进行分发。因此，平台要求中通常规定不允许录制用户背景音乐。对此，我们可以采用一种经济高效的解决方案（就 CPU 而言）来将游戏中的音乐和其余声音分开进行混音。使用 Secondary Output（二路输出）功能可完成该操作。

  对于禁止录制的声音，Xbox One、Xbox Series X、PlayStation 4 和 PlayStation 5 提供了专门接收它们的虚拟设备。You will need to create a new main bus to be able to define a different mix for this DVR-bypass Audio Device. 然后更改该新的总线上的 Audio Device 属性，使其指向 DVR-bypass 设备。随后声音可以正常输出到新的总线或子总线中。有关详细信息，请参阅[“了解 Secondary Output”一节](../../07-完善工程/01-管理输出/07-了解-Secondary-Output.md "了解 Secondary Output")。

---