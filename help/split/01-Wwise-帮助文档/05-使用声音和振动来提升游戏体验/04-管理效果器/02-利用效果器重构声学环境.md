# 利用效果器重构声学环境

[Wwise 帮助文档](../../00-Wwise-帮助文档.md) > [使用声音和振动来提升游戏体验](../00-使用声音和振动来提升游戏体验.md) > [管理效果器](00-管理效果器.md) > 利用效果器重构声学环境

## 利用效果器重构声学环境

Wwise 中有两种不同类型的总线，分别是：音频总线和辅助总线。辅助总线与发送系统可以用于实现环境音效。在辅助总线上应用效果器可以重新构建游戏环境对播放声音的影响方式，例如添加混响。辅助总线上的效果器还可以根据游戏对象的位置数据动态发挥作用。

以下章节介绍了在工程中如何在 Auxiliary Bus 上应用效果器。

### 理解发送

游戏内的环境声学效果可以被模拟出来，方法是在辅助总线上添加一系列效果器并将信号发送给该总线。您可以根据需要创建任意数量的辅助总线；不同总线对应于游戏中的不同环境。您还可以在游戏中使用 SDK 函数 [`SetBusEffect()`](https://www.audiokinetic.com/library/edge/?source=SDK&id=namespace_a_k_1_1_sound_engine_aabbeadd26d528e82003a0c143908d825.html) 动态地向辅助总线上添加效果器。在您为辅助总线定义了效果器后，您需要定义向这些总线发送信号的对象。

您可以选择使用用户定义的辅助发送来静态定义对象发送，也可以选择使用游戏定义的辅助发送，从而让游戏定义这些发送。

**创建辅助总线的方法如下：**

1. In the Busses hierarchy, create an Auxiliary Bus object.
2. 察看辅助总线。
3. 在辅助总线的 Effect（效果器）选项卡中，添加实现相应环境音效所需的效果器。

**使用用户定义的辅助发送将环境音效施加于对象的方法如下：**

1. Inspect the Containers hierarchy object.
2. 将辅助总线拖放至用户定义的辅助发送列表中。
3. 使用 Send volume（发送音量）滑杆定义要发送给辅助总线的信号量，即定义对象参与环境音效的程度。

**使用游戏定义的辅助发送将环境音效施加于对象的方法如下：**

1. Inspect the Containers hierarchy object.
2. 启用选项 **Use game-define auxiliary sends**（使用游戏定义辅助发送）。
3. 在游戏中，使用函数 `AK::SoundEngine::SetGameObjectAuxSendValues()` 为各个游戏对象指派一个辅助发送。

|  |  |
| --- | --- |
| [备注] | 备注 |
| 有关在游戏中映射环境的详细信息，请参阅 Wwise SDK - Windows > 声音引擎集成纵览 > 将 Wwise 元素集成到游戏中 > 集成环境和游戏定义的辅助发送，该章节位于[Wwise SDK 文档](https://www.audiokinetic.com/library/?source=SDK&id=integrating__elements__environments.html)中。您和音频程序员还可观看集成演示，该演示将向您展示如何设置辅助发送的示例。 |

### 利用 Auxiliary Send 重构声学环境 – 示例

假定您正在制作一款游戏，故事发生在幽灵出没的墓地内和附近。游戏中魅影重重，您希望这些幽灵在不同的环境中听起来不一样。在游戏的一个环节，玩家可以探索教堂、隧道和连接两者的楼梯。对于游戏的这一环节，您定义了以下辅助总线：

- 教堂
- 楼梯
- 隧道

您决定为这三个环境中的各个环境赋予一个独特的混响效果。例如，隧道的空间比教堂小，周围是石墙，形似洞穴，因此它的混响比在教堂中明显。在 Wwise 中，您可以创建一个具有更高混响各个层级和更短衰减时间的混响实例来匹配隧道中的音效，并可创建其它混响来匹配教堂和楼梯中的音效。然后，程序员可以将您创建的辅助总线映射到游戏几何空间结构上。产生的效果是，当幽灵进入隧道中时，幽灵发出的声音所产生的回音远远大于在教堂中的回音。

|  |
| --- |
|  |

Wwise 辅助发送还可以通过动态计算所有并行发送的发送音量来模拟在环境之间的移动。下图说明了此游戏示例的内置动态辅助总线通路和混音。

|  |
| --- |
|  |

对特定声音使用的各个发送的比例取决于各个游戏对象在游戏几何空间中的位置。在本例中，勇敢的玩家正从教堂沿着楼梯下到隧道，幽灵在后面紧追不舍。在穿过隧道的途中，可以将玩家和幽灵定义为 100% 处于楼梯环境，但还要加上 50% 处于教堂环境，40% 处于隧道环境。然后使用各个混响实例以适当的比例处理幽灵的声音。

### 将 Game-defined Auxiliary Send 集成到工作流程中

在 Wwise 中，您可以使用效果器创建和编辑辅助总线，以及定义哪个对象发送信号给它们。根据游戏对象的位置以编程方式为声音定义辅助发送。下面的步骤描述开发团队如何能够实现游戏定义的辅助发送：

- 音效设计师根据游戏中的环境定义辅助总线对象，例如小屋、教堂和洞穴。
- 音效设计师需确保应受环境效果影响的所有声音都启用了 **Use game-defined auxiliary sends** 选项。
- 当环境出现在游戏几何空间中时，游戏程序员将辅助总线映射到环境中。
- 游戏程序员要创建一个机制来实时计算出环境比例值，并将比例值报告给声音引擎。
- 声音引擎会计算哪一条辅助总线将运用于各个游戏对象所触发的声音。

---