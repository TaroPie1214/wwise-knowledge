# 管理交叉淡变

[Wwise 帮助文档](../../../00-Wwise-帮助文档.md) > [使用声音和振动来提升游戏体验](../../00-使用声音和振动来提升游戏体验.md) > [定义对象播放行为](../00-定义对象播放行为.md) > [定义 Blend Container 的内容和行为](00-定义-Blend-Container-的内容和行为.md) > 管理交叉淡变

### 管理交叉淡变

混合容器允许同时播放多个对象。在 Blend Track 中启用交叉淡变会改变这些对象的听感和振动。为了便于管理交叉淡变，Blend Track 内的各个对象都显示为长方块。这些长方块将显示在图中，而 X 轴代表游戏参数的变化。这些长方块在 X 轴上的位置表示游戏参数值，当游戏参数位于相应的 X 轴区间时，将听到对应的声音或感受到振动。

当您重叠方块来创建交叉淡变时，会让对象间的过渡更平滑，增加游戏的真实感。交叉淡变也可以与混合容器的Blend Track中的 RTPC 曲线一起使用，来改变对象的属性。

#### 管理交叉淡变 – 示例

例如，假设您的游戏是过山车模拟游戏。游戏玩家可构建速度为 0 - 200 km/h 不等的过山车。最基本的设计方法，可以使用混合容器将 RTPC 指派给过山车的乘客声音，当过山车加速时，的乘客声的音量会增加。假设您已经收集了各种不同的声音来表现乘客反应，从发牢骚、激动喝彩到惊恐的尖叫。如果使用混合容器来组织这些声音，则可以根据过山车的行驶速度，有选择性地播放这些不同的声音。例如，当过山车的速度达到 40 km/h 时，就能开始听到激动喝彩声。玩家可听到不同乘客的声音，并会听到每种声音的音量在增加。

|  |
| --- |
|  |

#### 使用交叉淡变

要在混合容器中使用交叉淡变，您首先需要启用它们。然后可以调整长方块的大小。当游戏参数到达方块所在的 X 轴区间时，就能够听到该对象。当您重叠这些长方块时，就创建了一个交叉淡变。

交叉淡变可以帮助组织播放混合容器内的对象。由于混合容器中的所有声音或振动对象会根据 RTPC 映射同时播放，因此使用交叉淡变可以在对象间实现更平滑的过渡。例如，如果您创建了一个 RTPC 来表现游戏中的时光流逝，则可以让蟋蟀声和鸟鸣声重叠并应用交叉淡变，来营造黎明氛围。

|  |
| --- |
|  |

**使用交叉淡变的方法如下：**

1. 在 Blend Track Editor 中，选择要添加交叉淡变的 Blend Track。

   Blend Track 将变为可用。
2. 选择 Crossfading 选项。

   Game Parameter 列表变为可用。
3. 选择游戏参数，您将以此参数为基础在该 Blend Track 中应用交叉淡变。

   表示对象的长方块将显示在 Blend Track 中，X 轴表示游戏参数。

   Blend Track 中的各个对象在图中都表示为彩色块。这些长方块的颜色与内容编辑器的 Blend Track 中列出的对象颜色相同。
4. 选择某个长方块，并向左或向右拖动其边缘以调整其大小和位置。

   播放时，将按照 X 轴所示播放相应的对象。

#### 结合使用交叉淡变和 RTPC

您可以通过 Blend Track 将 RTPC 曲线的强大功能与交叉淡变的灵活性相结合。在混合容器内，您可以根据游戏参数设置对象之间的交叉淡变，然后为这些相同的对象应用 RTPC 曲线。

|  |
| --- |
|  |

记住，在 Blend Track 中的交叉淡变和 RTPC 曲线可以是基于不同参数的。例如，在过山车模拟游戏中，您可以使用 RTPC 曲线在过山车角度变得陡峭时，提升乘客叫声的音高。但您同时可以为该 Blend Track 添加基于速度的交叉淡变，从而在速度改变时听到不同的声音。因此，当过山车提速时，您可以听到声音的内容变化，当过山车角度更陡峭时，这些声音的音调会变得更高。

|  |
| --- |
|  |

#### 设置交叉淡变模式

Wwise 可以用不同的方式处理交叉淡变，这完全取决于您的偏好。可以使用以下三种方法调整 Blend Track 中各对象间的交叉淡变：

- **None**（无）：在参数值进入方块重叠的部分时，RTPC 的属性立即从最大值过渡到最小值（反之亦然）。
- **Automatic（自动）（默认）：**淡变范围等于相邻方块的重叠部分宽度。如果没有相邻方块，则没有淡变。
- **Manual（手动）：**您可以移动淡入结束或淡出起始的点。淡入起始或淡出结束的点将总是在重叠块的外部下角处开始。

|  |  |
| --- | --- |
| [备注] | 备注 |
| 您也可以修改交叉淡变曲线的形状。有关设置曲线形状的详情，请参阅 [“指定控制点之间曲线的形状”一节](../../../08-使用-Wwise/07-了解坐标图视图/03-在坐标图中使用曲线.md#specifying_shape_of_curve_between_control_points "指定控制点之间曲线的形状")。 |

**选择交叉淡变模式的方法如下：**

1. 右键点击长方块的边缘，并点击选择一个模式。

#### 使用交叉淡变过渡的注意事项

下面列出了在 **Random Container**（随机容器）或 **Sequence Container**（序列容器）内使用交叉淡变过渡时需要注意的一些事项。

- 音频文件长度

  - 音频文件长度必须大于或等于 0.2 秒。
  - 交叉淡变时间最短为 0.1 秒。
- 交叉淡变时间与音频文件长度的关系

  - 从声音 A 交叉淡变至声音 B 时，声音引擎所允许的淡变时间最长为音频文件 A 长度的一半。如果淡变时间大于允许的最大值，那么将被自动调整为淡出文件长度的一半。

    |  |  |
    | --- | --- |
    | [备注] | 备注 |
    | 如果交叉淡变对于容器内的若干个音频文件过长，则 Wwise 将不会进行限制或提示点。如果需要对交叉淡变时间进行调整，声音引擎会在运行时进行处理。 |
- 暂停和交叉淡变

  - 如果暂停播放使用交叉淡变过渡的声音，同时向暂停操作应用淡出，交叉淡变的时机可能会不准确。
- 音高和交叉淡变

  - 如果使用 RTPC 设置了容器的音高值，或在播放容器时触发了 "Set Pitch" Event Action，则在声音之间应用交叉淡变时可能会出现不符合预期的结果。
- 源插件与交叉淡变

  - 在对源插件应用交叉淡变时，如果无法确定源的结束时间，那么交叉淡变可能会被忽略。例如，当正弦波生成源的时长基于一个 RTPC 时，就会发生这种情况。在这些情况下，交叉淡变被忽略，并且过渡将会在没有交叉淡变的情况下完成。
- 切换容器与交叉淡变

  - 当 **Switch Container** 作为 **Sequence Container** 的子容器时，会根据指派给切换开关的对象数量，区别应用交叉淡变过渡。
- 两个声部

  - 交叉淡变期间，声音引擎会使用两个不同的声部。
- 虚声部和交叉淡变

  - 根据定义，在低于音量阈值或超过播放数量限制时，**Play from Beginning** 和 **Resume** 虚声部行为会影响声音持续时间，这不在交叉淡变时间机制的考虑范围之内。
  - 在音量降到阈值以下时，声部可能会转为虚声部。对于任何声音，会使用其所有音频通道的实际有效音量与阈值相比较。This includes resulting from the contribution of all volumes of the Containers hierarchy, Fade transitions, Interactive-music transitions, RTPCs, States, positioning, and attenuations.
  - 当计算声音的有效音量时，淡变过渡的音量影响也计算在内。因此，在 **Random**、**Sequence** 或  **Blend Container** 内的交叉淡变过渡期间，淡变声音在某些时候将有可能低于音量阈值。如果它们从虚声部恢复时的行为是**Play from Beginning**或**Resume**，则其真实时长将长于容器淡变的逻辑所预期的时长。这将导致不可预测的行为。更糟糕的是，当声音淡出至低于阈值时，它会停止发声，但仍进行“虚拟”播放，因此永远不会结束。因此，容器将可能停止播放后续声音。

  总而言之，建议避免对应用交叉淡变过渡的容器使用这些类型的虚声部。如果对这些容器使用虚声部，建议选择 **Play from elapsed time**（继续播放，如同从未停止播放一样）行为。

---