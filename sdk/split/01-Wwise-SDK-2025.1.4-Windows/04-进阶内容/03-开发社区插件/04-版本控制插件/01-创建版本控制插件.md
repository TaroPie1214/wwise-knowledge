# 创建版本控制插件

|  |
| --- |
| Wwise SDK 2025.1.4 - Windows |

创建版本控制插件

创建 Wwise 版本控制插件 DLL 需要以下步骤：

- [创建工程](source_control_dll.html#source_control_dll_creation_new_project)
- [创建版本控制插件接口](source_control_dll.html#source_control_dll_creation_object)
- [实现版本控制操作](source_control_dll.html#source_control_dll_implementing_actions)
- [定义版本控制插件对话框](source_control_dll.html#source_control_dll_creation_dialog)

|  |  |
| --- | --- |
|  | **备注:** 一个 DLL 中可以包含多个插件。更多信息请参阅 [建立导出函数](source_control_dll.html#source_control_dll_creation_exported) 。 |

# 开始新工程

在开始新的工程时，必须新建工程，并创建将在工程中使用的导出函数。

- [创建工程](source_control_dll.html#source_control_dll_creation_new_project)
- [建立导出函数](source_control_dll.html#source_control_dll_creation_exported)

您还应熟悉将在工程中使用的版本控制接口。

- [版本控制接口](source_control_dll.html#source_control_dll_creation_interfaces)

## 创建工程

要使用 Visual Studio 创建工程，请执行以下步骤：

1. 创建 MFC DLL C++ 工程。In the MFC DLL Wizard dialog, the DLL type must be set to Regular DLL using shared MFC DLL.
2. 在新工程中，打开 Project Properties 对话框并执行以下步骤：

- 在 General Property 页面，将 Character Set 属性设置为 Use Unicode Character Set。
- In the C/C++/General Property page, add the path to the SDK includes directory in the Additional Include Directories property.

工程将被创建并配置为使用 Wwise Source Control SDK。The next thing to do is to create the functions that Wwise will use to manage your plug-in DLL.

|  |  |
| --- | --- |
|  | **技巧:** 严格来说无需创建 MFC DLL 工程。However, this does facilitate certain string and dialog manipulations. If you choose not to use an MFC DLL, make sure to include the oleauto.h header in the stdafx.h file to be able to use the `SysAllocString` function. |

## 建立导出函数

每个插件 DLL 必须导出三个函数：

- AkSourceControlGetPluginIDList(): Lets Wwise access the list of plug-ins contained in the DLL by getting the list of all plug-in IDs.
- AkSourceControlGetPluginInfo(): Lets Wwise access the [AK::Wwise::ISourceControl::PluginInfo](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info.html "Plug-in information structure. This structure gives a simple overview of the plug-in's capabilities.") class associated with a given plug-in.
- AkSourceControlCreatePlugin()：创建一个 [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html) 对象。

这些导出函数的原型可以在下列类型定义中找到：

- [AK::Wwise::ISourceControl::GetSourceControlIDListFuncPtr](class_a_k_1_1_wwise_1_1_i_source_control_a5884432f102b445c4c3de021a3867e46.html#a5884432f102b445c4c3de021a3867e46 "Gets the plug-in ID list contained by the DLL file.")
- [AK::Wwise::ISourceControl::GetSourceControlPluginInfoFuncPtr](class_a_k_1_1_wwise_1_1_i_source_control_a9e3376c6dbaa3e6094e21e04aa2a28e1.html#a9e3376c6dbaa3e6094e21e04aa2a28e1 "Gets the AK::Wwise::ISourceControl::PluginInfo class associated with a given plug-in ID.")
- [AK::Wwise::ISourceControl::GetSourceControlInstanceFuncPtr](class_a_k_1_1_wwise_1_1_i_source_control_a5ea75c450aecec73c2b29f51d990a206.html#a5ea75c450aecec73c2b29f51d990a206)

对于包含两个插件的插件 DLL，其导出函数如下列所示：

#include "[AK/Wwise/SourceControl/ISourceControl.h](_i_source_control_8h.html)"

#include "SamplePlugin.h"

namespace

{

// FirstSamplePlugin ID = {BD47DF98-1700-4542-A33F-E44705C25AF0}

static const GUID s\_guidFirstSamplePluginID =

{ 0xbd47df98, 0x1700, 0x4542, { 0xa3, 0x3f, 0xe4, 0x47, 0x5, 0xc2, 0x5a, 0xf0 } };

// SecondSamplePlugin ID = {57168691-2354-4166-82BF-DD07A36C16C6}

static const GUID s\_guidSecondSamplePluginID =

{ 0x57168691, 0x2354, 0x4166, { 0x82, 0xbf, 0xdd, 0x7, 0xa3, 0x6c, 0x16, 0xc6 } };

}

void \_\_stdcall AkSourceControlGetPluginIDList ( [AK::Wwise::ISourceControl::PluginIDList](class_a_k_1_1_wwise_1_1_source_control_containers_1_1_i_ak_list.html)& out\_rPluginIDList )

{

out\_rPluginIDList.[AddTail](class_a_k_1_1_wwise_1_1_source_control_containers_1_1_i_ak_list_ad148966a617cb4164a43b3772bb4f321.html#ad148966a617cb4164a43b3772bb4f321)( s\_guidFirstSamplePluginID );

out\_rPluginIDList.[AddTail](class_a_k_1_1_wwise_1_1_source_control_containers_1_1_i_ak_list_ad148966a617cb4164a43b3772bb4f321.html#ad148966a617cb4164a43b3772bb4f321)( s\_guidSecondSamplePluginID );

}

void \_\_stdcall AkSourceControlGetPluginInfo ( const GUID& in\_rguidPluginID,

[AK::Wwise::ISourceControl::PluginInfo](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info.html)& out\_rPluginInfo )

{

if ( in\_rguidPluginID == s\_guidFirstSamplePluginID )

{

FirstSamplePlugin::GetPluginInfo( out\_rPluginInfo );

}

else if ( in\_rguidPluginID == s\_guidSecondSamplePluginID )

{

SecondSamplePlugin::GetPluginInfo( out\_rPluginInfo );

}

}

[AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html)\* \_\_stdcall AkSourceControlCreatePlugin ( const GUID& in\_rguidPluginID )

{

[AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html)\* pSourceControl = NULL;

if ( in\_rguidPluginID == s\_guidFirstSamplePluginID )

{

pSourceControl = new FirstSamplePlugin();

}

else if ( in\_rguidPluginID == s\_guidSecondSamplePluginID )

{

pSourceControl = new SecondSamplePlugin();

}

return pSourceControl;

}

|  |  |
| --- | --- |
|  | **警告:** 必须更改插件 GUID 值，以避免 ID 与其他插件发生冲突。 |

When you create a project with Visual Studio, you need to export these functions by adding the function names to the .def file of the project. If no module definition file exists, you must create one.

请按照下列步骤创建模块定义文件：

1. 单击工具栏上的 **Add New Item** 按钮。
2. 在模板列表中选择 **Module-Definition File (.def)** 模板。

典型的模块定义文件如下所示：

LIBRARY "SamplePlugin"

EXPORTS

AkSourceControlGetPluginIDList

AkSourceControlGetPluginInfo

AkSourceControlCreatePlugin

## 版本控制接口

每个 Wwise 版本控制插件必须包含特定接口才能被正确集成。这些接口汇总如下，稍后将对它们进行详细介绍。

### AK::Wwise::ISourceControl

插件必须应用此接口才能执行版本控制操作。

有关此接口的更多信息，请参阅 [创建版本控制插件接口](source_control_dll.html#source_control_dll_creation_object) 。

### AK::Wwise::ISourceControlUtilities

此接口由 Wwise 应用，并在创建时提供给插件。It exposes some useful utility functions to the plug-in.

有关此接口的更多信息，请参阅 [使用版本控制实用函数接口](source_control_dll.html#source_control_dll_creation_utilities) 。

### AK::Wwise::ISourceControlOperationProgress

This interface is implemented by Wwise and is given to the plug-in via the ISourceControlUtilities class. 它提供了管理简单进度对话框的函数。

有关此接口的更多信息，请参阅 [实现版本控制操作进度接口](source_control_dll.html#source_control_dll_creation_progress) 。

### AK::Wwise::ISourceControlDialogBase

This is the interface that the plug-in must implement to create dialogs that have the Wwise UI look and feel.

有关此接口的更多信息，请参阅 [定义版本控制插件对话框](source_control_dll.html#source_control_dll_creation_dialog) 。

# 创建版本控制插件接口

When you implement the methods of [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html), you define the behavior of your plug-in in response to various situations in Wwise. The methods allow the plug-in to react to the following situations:

- 初始化或终止插件时
- 销毁插件时
- 音频设计师单击 Project Settings 对话框中的“Config…”按钮时
- Wwise 刷新 Project Explorer 中的图标时
- 在 File Manager 内刷新 Work Units 或 Sources 选项卡中的文件列表时
- 显示包含版本控制操作的上下文菜单时
- The Wwise user selects an operation from the contextual menu in the File Manager or in the Project Explorer
- 更新文件时
- 音频设计师导入音频文件、创建新的工作单元或者保存工程时。

Some of these situations are covered in the following sections, but you can refer directly to the [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html) reference for a complete description of the interface and the functions you need to implement.

|  |  |
| --- | --- |
|  | **技巧:** Many methods in this interface have the [AK::Wwise::ISourceControl::OperationResult](class_a_k_1_1_wwise_1_1_i_source_control_acf444a7a6671eacbee4a2a29aeb82286.html#acf444a7a6671eacbee4a2a29aeb82286) enumeration as return type. It is important to note that the OperationResult\_Failed result must be used only when the operation fails globally; that is, when you don't want Wwise to consider data that is returned by the plug-in. 所述失败包括以下情况：  - 连接失败。 - 发生内部插件错误。 |

## 代码示例

You must create a class derived from [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html) to implement all methods of this interface. This class manages everything related to UI and source control operations for your plug-in. The context in which these methods are called is indicated in the comments.

#include <AK/Wwise/ISourceControl.h>

class SamplePlugin

: public [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html)

{

public:

SamplePlugin();

virtual ~SamplePlugin();

// ISourceControl 实现

virtual void [Init](class_a_k_1_1_wwise_1_1_i_source_control_a965c84c993e7b9644a7d51dafcdeb113.html#a965c84c993e7b9644a7d51dafcdeb113)([AK::Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html)\* in\_pUtilities ); // Initializing and Terminating the

// Plug-in Instance

virtual void [Term](class_a_k_1_1_wwise_1_1_i_source_control_a488a4e256024111dc7c3eceef7970b11.html#a488a4e256024111dc7c3eceef7970b11)(); // Initializing and Terminating the Plug-in Instance

virtual void [Destroy](class_a_k_1_1_wwise_1_1_i_source_control_a7682bc6fd40d00c825703604ab79fc85.html#a7682bc6fd40d00c825703604ab79fc85)(); // Destroying the Plug-in Instance

virtual bool [ShowConfigDlg](class_a_k_1_1_wwise_1_1_i_source_control_a895acce7b436743e5519245529c97ecd.html#a895acce7b436743e5519245529c97ecd)(); // Plug-in configuration

virtual void [GetOperationList](class_a_k_1_1_wwise_1_1_i_source_control_ad7820c108e50155039c92223eff718f3.html#ad7820c108e50155039c92223eff718f3)( OperationMenuType in\_menuType, const StringList& in\_rFilenameList,

OperationList& out\_rOperationList ); // Contextual Menu

virtual DWORD [GetOperationEffect](class_a_k_1_1_wwise_1_1_i_source_control_a1cb1c283baf8b61df030a862dd2dc880.html#a1cb1c283baf8b61df030a862dd2dc880)(

DWORD in\_dwOperationID ); // Wwise needs to know the effect of an operation

virtual LPCWSTR [GetOperationName](class_a_k_1_1_wwise_1_1_i_source_control_a817835af7fd2e208f9ba202d6eb5a2eb.html#a817835af7fd2e208f9ba202d6eb5a2eb)(

DWORD in\_dwOperationID ); // Get operation name

virtual AK::Wwise::ISourceControlUtilities::OperationResult [GetFileStatus](class_a_k_1_1_wwise_1_1_i_source_control_ad9ed25401176139c3185a5980b6d44d4.html#ad9ed25401176139c3185a5980b6d44d4)(

const StringList& in\_rFilenameList,

FilenameToStatusMap& out\_rFileStatusMap ); // File Manager Dialog

virtual AK::Wwise::ISourceControlUtilities::OperationResult [GetFileStatusIcons](class_a_k_1_1_wwise_1_1_i_source_control_a177b1676aeffa151c86255a7b747fcdc.html#a177b1676aeffa151c86255a7b747fcdc)(

const StringList& in\_rFilenameList,

FilenameToIconMap& out\_rFileIconsMap ); // Project Explorer Icons Refresh

virtual AK::Wwise::ISourceControlUtilities::OperationResult [GetMissingFilesInDirectories](class_a_k_1_1_wwise_1_1_i_source_control_acda8ef1d7727c6ba45d302f4c4ee339e.html#acda8ef1d7727c6ba45d302f4c4ee339e)(

const StringList& in\_rDirectoryList, StringList& out\_rFilenameList ); // File Manager Dialog

virtual void [DoOperation](class_a_k_1_1_wwise_1_1_i_source_control_a36789a297bc4a85ba0fffb9de9bc0a6f.html#a36789a297bc4a85ba0fffb9de9bc0a6f)( DWORD in\_dwOperationID, const StringList& in\_rFilenameList ); // Execution of a

// Source Control Operation

virtual AK::Wwise::ISourceControlUtilities::OperationResult [PreCreateOrModify](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7)(

const StringList& in\_rFilenameList,

bool& out\_rContinue ); // Creation or Modification of Files in Wwise

virtual AK::Wwise::ISourceControlUtilities::OperationResult [PostCreateOrModify](class_a_k_1_1_wwise_1_1_i_source_control_a9fb467f0d5dbcb386290f53a81bb8dc5.html#a9fb467f0d5dbcb386290f53a81bb8dc5)(

const StringList& in\_rFilenameList,

bool& out\_rContinue ); // Creation or Modification of Files in Wwise

// A static method to get the plug-in information class, refer to Source Control Plug-in Information Class

// for more information about this method.

static void GetPluginInfo( [PluginInfo](namespace_a_k_1_1_wwise_1_1_plugin_a69141ebf4159597c1e76aad07862c823.html#a69141ebf4159597c1e76aad07862c823)& out\_rPluginInfo );

private:

// 成员

[AK::Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html)\* m\_pSourceControlUtilities;

};

|  |  |
| --- | --- |
|  | **注意:** The string parameters and results exchanged between Wwise and the source control plug-in must be in unicode. |

## 构建版本控制插件信息类

When Wwise requires information about your plug-in, it calls the AkSourceControlGetPluginInfo function exported from your DLL. （更多信息请参阅 [建立导出函数](source_control_dll.html#source_control_dll_creation_exported) 。) The [AK::Wwise::ISourceControl::PluginInfo](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info.html "Plug-in information structure. This structure gives a simple overview of the plug-in's capabilities.") class is composed of the following data:

- 为用户显示的插件名称
- 插件的版本
- A Boolean value that notifies Wwise that source control icons for work unit nodes can be displayed in the Project Explorer
- 用于告知 Wwise 是否可以配置插件的布尔值
- 用于告知 Wwise 是否可以使用 Update All 操作的布尔型值
- 为用户显示的 Update All 操作的名称

|  |  |
| --- | --- |
|  | **技巧:** A simple way to obtain the plug-in information is to make the AkSourceControlGetPluginInfo ([建立导出函数](source_control_dll.html#source_control_dll_creation_exported)) call a static method created inside your implementation of the [AK::Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html) interface.  该静态方法的简单实现如下：  void SamplePlugin::GetPluginInfo( [PluginInfo](namespace_a_k_1_1_wwise_1_1_plugin_a69141ebf4159597c1e76aad07862c823.html#a69141ebf4159597c1e76aad07862c823)& out\_rPluginInfo )  {  // 插件名称和版本  out\_rPluginInfo.m\_bstrName = ::SysAllocString( L"Sample Source Control Plug-in" );  out\_rPluginInfo.m\_uiVersion = 1;    // 函数可用性  out\_rPluginInfo.m\_bShowConfigDlgAvailable = false;  out\_rPluginInfo.m\_dwUpdateCommandID = [AK::Wwise::SourceControlConstant::s\_dwInvalidOperationID](class_a_k_1_1_wwise_1_1_source_control_constant_ab76ee63c449ed45e8e4f4cdf693dbbb5.html#ab76ee63c449ed45e8e4f4cdf693dbbb5);// Replace with your ID  out\_rPluginInfo.m\_dwCommitCommandID = [AK::Wwise::SourceControlConstant::s\_dwInvalidOperationID](class_a_k_1_1_wwise_1_1_source_control_constant_ab76ee63c449ed45e8e4f4cdf693dbbb5.html#ab76ee63c449ed45e8e4f4cdf693dbbb5);// Replace with your ID  out\_rPluginInfo.m\_bStatusIconAvailable = false;  } |

|  |  |
| --- | --- |
|  | **警告:** The plug-in name and the Update All operation name must be allocated using the SysAllocString function, because Wwise is responsible for deleting this memory. |

## 初始化和终止插件

When the plug-in instance is created, Wwise calls the AK::Wwise::ISourceControl::Init( ISourceControlUtilities\* in\_pUtilities ) method. The parameter of this function is a pointer to Wwise's implementation of the [AK::Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html) interface. You might want to copy this pointer to a member of your plug-in class to be able to create dialogs, show a progress dialog, display message boxes, or load and save plug-in configuration. 更多相关信息，请参阅 [使用版本控制实用函数接口](source_control_dll.html#source_control_dll_creation_utilities) 。

[AK::Wwise::ISourceControl::Init()](class_a_k_1_1_wwise_1_1_i_source_control_a965c84c993e7b9644a7d51dafcdeb113.html#a965c84c993e7b9644a7d51dafcdeb113 "This function is called when the plug-in is initialized after its creation.") 的典型实现如下：

void [SamplePlugin::Init](namespace_a_k_1_1_comm_a596691b552b507c26b4df958ee1c6de8.html#a596691b552b507c26b4df958ee1c6de8)( ISourceControlUtilities\* in\_pUtilities )

{

m\_pSourceControlUtilities = in\_pUtilities;

// 从注册表中加载插件配置

}

在销毁插件之前，Wwise 将调用 [AK::Wwise::ISourceControl::Term()](class_a_k_1_1_wwise_1_1_i_source_control_a488a4e256024111dc7c3eceef7970b11.html#a488a4e256024111dc7c3eceef7970b11 "This function is called when the plug-in is terminated before its destruction.") 方法。

[AK::Wwise::ISourceControl::Term()](class_a_k_1_1_wwise_1_1_i_source_control_a488a4e256024111dc7c3eceef7970b11.html#a488a4e256024111dc7c3eceef7970b11 "This function is called when the plug-in is terminated before its destruction.") 的典型实现如下：

void [SamplePlugin::Term](namespace_a_k_1_1_comm_a94e307d2974b89cc4fbc8ab0fef20d2f.html#a94e307d2974b89cc4fbc8ab0fef20d2f)()

{

// 将插件配置保存到注册表

m\_pSourceControlUtilities = NULL;

}

关于加载/保存插件配置到注册表的更多信息，请参阅 [版本控制插件例程](referencematerial_samplecode_source_control.html) 。

关于何时调用这些函数的更多信息，请参阅 [销毁插件](source_control_dll.html#source_control_dll_creation_object_destroy) 。

## 销毁插件

When Wwise needs to create an instance of your source control plug-in, it calls the AkSourceControlCreatePlugin() function in your DLL ([建立导出函数](source_control_dll.html#source_control_dll_creation_exported)) to create the new instance. 此函数将向版本控制插件返回一个接口。When the plug-in instance is no longer needed, Wwise calls the [AK::Wwise::ISourceControl::Destroy()](class_a_k_1_1_wwise_1_1_i_source_control_a7682bc6fd40d00c825703604ab79fc85.html#a7682bc6fd40d00c825703604ab79fc85 "This function destroys the plug-in. The implementation is generally '{ delete this; }'.") method on that particular instance. This method releases any memory or other resources the object consumes, and then deletes the object itself.

If the instance was created with the operator New, a typical implementation of [AK::Wwise::ISourceControl::Destroy()](class_a_k_1_1_wwise_1_1_i_source_control_a7682bc6fd40d00c825703604ab79fc85.html#a7682bc6fd40d00c825703604ab79fc85 "This function destroys the plug-in. The implementation is generally '{ delete this; }'.") would be:

void SamplePlugin::Destroy()

{

delete this;

}

下列情况下将创建一个插件：

- The Wwise user selects it from the source control plug-in list in the Project Settings dialog and accepts the changes
- 音频设计师加载使用了该版本控制插件的工程时。

下列情况下将销毁插件：

- The Wwise user selects another source control plug-in from the Project Settings dialog and accepts the changes;
- 关闭工程时。

## 使用版本控制实用函数接口

该接口将在插件初始化时提供（请参阅 [初始化和终止插件](source_control_dll.html#source_control_dll_creation_object_init_term) ）。 Its functions help the plug-in create dialogs, display message boxes, show a progress dialog, and load and save the configuration, all with the Wwise UI look and feel.

此接口提供以下方法：

- AK::Wwise::ISourceControlUtilities::GetProgressDialog()；
- [AK::Wwise::ISourceControlUtilities::MessageBox( HWND in\_hWnd, LPCWSTR in\_lpText, LPCWSTR in\_lpCaption, UINT in\_uiType )](class_a_k_1_1_wwise_1_1_i_source_control_utilities_a736122aef2131361b82063d4a43b765e.html#a736122aef2131361b82063d4a43b765e)；
- [AK::Wwise::ISourceControlUtilities::CreateModalCustomDialog( ISourceControlDialogBase\* in\_pDialog )](class_a_k_1_1_wwise_1_1_i_source_control_utilities_a6e7f5369fce4769309e2ba6fe5ed72d1.html#a6e7f5369fce4769309e2ba6fe5ed72d1)；
- AK::Wwise::ISourceControlUtilities::GetRegistryPath()。

### 显示进度对话框

When performing source control operations, it can be useful to display a progress dialog with progress feedback messages. This can be done by calling the AK::Wwise::ISourceControlUtilities::GetProgressDialog() method. 该方法将返回 AK::Wwise::ISourceControlOperationProgress 接口。For more information on this interface, refer to [实现版本控制操作进度接口](source_control_dll.html#source_control_dll_creation_progress).

### 显示消息对话框

A simple way to display message boxes with the Wwise UI look and feel is to call the [AK::Wwise::ISourceControlUtilities::MessageBox()](class_a_k_1_1_wwise_1_1_i_source_control_utilities_a736122aef2131361b82063d4a43b765e.html#a736122aef2131361b82063d4a43b765e) method. Use it the same way as a standard `MessageBox` Windows function call. You should use this method rather than the standard `MessageBox` calls to give your plug-in the Wwise UI look and feel.

### 显示对话框

To create dialogs that have the Wwise UI look and feel, you have to call the [AK::Wwise::ISourceControlUtilities::CreateModalCustomDialog( ISourceControlDialogBase\* in\_pDialog )](class_a_k_1_1_wwise_1_1_i_source_control_utilities_a6e7f5369fce4769309e2ba6fe5ed72d1.html#a6e7f5369fce4769309e2ba6fe5ed72d1) method. This method works in the same way as the CDialog::DoModal() method except that it accepts an [AK::Wwise::ISourceControlDialogBase](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base.html) interface as input. 有关这一点的更多信息，请参阅 [定义版本控制插件对话框](source_control_dll.html#source_control_dll_creation_dialog) 。

### 显示进度对话框

[AK::Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html) offers a simple way to save or load the plug-in configuration in the registry. By calling the AK::Wwise::ISourceControlUtilities::GetRegistryPath() method, you obtain the path of a registry folder that is different for each project and each plug-in. To load or save the configuration, you should create a subfolder for the current version of the plug-in and create all plug-in keys there. You might want to load the configuration in the [AK::Wwise::ISourceControl::Init()](class_a_k_1_1_wwise_1_1_i_source_control_a965c84c993e7b9644a7d51dafcdeb113.html#a965c84c993e7b9644a7d51dafcdeb113 "This function is called when the plug-in is initialized after its creation.") method and save the configuration in the [AK::Wwise::ISourceControl::Term()](class_a_k_1_1_wwise_1_1_i_source_control_a488a4e256024111dc7c3eceef7970b11.html#a488a4e256024111dc7c3eceef7970b11 "This function is called when the plug-in is terminated before its destruction.") method.

|  |  |
| --- | --- |
|  | **警告:** 必须使用 HKEY\_CURRENT\_USER 注册表键来访问此路径。The project registry folder is created using this key and the source control plug-in configuration must be user-independent. |

## 实现版本控制操作进度接口

The AK::Wwise::ISourceControlOperationProgress interface's implementation can be accessed via the [AK::Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html) interface given to the plug-in upon initialization. 前一个接口提供以下方法：

- AK::Wwise::ISourceControlOperationProgress::ShowProgress();
- AK::Wwise::ISourceControlOperationProgress::AddLogMessage(LPCWSTR in\_pszMessage );
- AK::Wwise::ISourceControlOperationProgress::IsCanceled();
- AK::Wwise::ISourceControlOperationProgress::Cancel();
- AK::Wwise::ISourceControlOperationProgress::OperationCompleted().

### 创建进度对话框

To create and display the progress dialog, use the AK::Wwise::ISourceControlOperationProgress::ShowProgress() non-blocking method. To add a message to the log message list, use the AK::Wwise::ISourceControlOperationProgress::AddLogMessage() method.

|  |  |
| --- | --- |
|  | **警告:** 进度对话框不考虑转义符（例如“\n”或“\t”）。The text must be added line by line and tabulation must be replaced with blank spaces. |

### 启用 OK 按钮

To enable the OK button, call the AK::Wwise::ISourceControlOperationProgress::OperationCompleted() method. 此方法将在用户点击 OK 按钮之后才会返回结果。When the user does so, the dialog is closed and destroyed.

### 启用 Cancel 按钮

To know if the user has pressed the Cancel button, call the AK::Wwise::ISourceControlOperationProgress::IsCanceled() method. You can also cancel the operation by calling the AK::Wwise::ISourceControlOperationProgress::Cancel() method.

|  |  |
| --- | --- |
|  | **备注:** Even if you programmatically cancel the dialog by calling the AK::Wwise::ISourceControlOperationProgress::Cancel() method, you still have to call AK::Wwise::ISourceControlOperationProgress::OperationCompleted() to close and destroy the dialog. |

# 实现版本控制操作

要将您的版本控制插件集成到 音频设计师的工作流程中，必须按照如下方式实现下列功能。

- [启用插件配置](source_control_dll.html#source_control_dll_creation_object_config)
- [启用 File Manager 对话框](source_control_dll.html#source_control_dll_creation_object_workgroup)
- [在上下文菜单中显示插件](source_control_dll.html#source_control_dll_creation_object_contextual)
- [在上下文菜单中显示版本控制操作](source_control_dll.html#source_control_dll_creation_object_execution)
- [允许 Wwise 刷新 Project Explorer 图标](source_control_dll.html#source_control_dll_creation_object_icons)
- [允许在 Wwise 中创建和修改文件](source_control_dll.html#source_control_dll_creation_object_creation)

## 启用插件配置

In the Project Settings dialog, the Wwise user can configure the plug-in by clicking the Config… button. This button is enabled only if the [AK::Wwise::ISourceControl::PluginInfo::m\_bShowConfigDlgAvailable](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info_a8bbaffdff539c62271eba2e5ae4b2712.html#a8bbaffdff539c62271eba2e5ae4b2712 "Used to enable/disable the 'Config...' button in the Project Settings") has been set to True. 单击此按钮时，Wwise 将调用 [AK::Wwise::ISourceControl::ShowConfigDlg()](class_a_k_1_1_wwise_1_1_i_source_control_a895acce7b436743e5519245529c97ecd.html#a895acce7b436743e5519245529c97ecd) 方法。The return value of this function is a Boolean value. 其含义如下：

- True indicates that you accepted the configuration changes, so the Project Explorer icons will be refreshed.
- False indicates that you rejected the configuration changes, so the Project Explorer icons will not be refreshed.

此方法的典型实现如下：

bool SamplePlugin::ShowConfigDlg()

{

DlgConfiguration configurationDialog();

// 如果用户点击“OK”，则返回 True

return m\_pSourceControlUtilities->CreateModalCustomDialog( &configurationDialog ) == IDOK;

}

In this code sample, the DlgConfiguration class is an implementation of the [AK::Wwise::ISourceControlDialogBase](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base.html) interface. 更多信息请参阅 [定义版本控制插件对话框](source_control_dll.html#source_control_dll_creation_dialog) 。

## 启用 File Manager 对话框

当刷新 File Manager 时，将调用两个方法：

- [AK::Wwise::ISourceControl::GetMissingFilesInDirectories( const StringList& in\_rDirectoryList, StringList& out\_rFilenameList )](class_a_k_1_1_wwise_1_1_i_source_control_acda8ef1d7727c6ba45d302f4c4ee339e.html#acda8ef1d7727c6ba45d302f4c4ee339e)
- AK::Wwise::ISourceControl::GetFileStatus( const StringList& in\_rFilenameList, FilenameToStatusMap& out\_rFileStatusMap )

当生成文件列表时，Wwise 将搜索磁盘上的文件。On some source control systems, however, files are removed from the disk when they are deleted. Despite this, these files must still be identified to confirm the delete operation on the server. To retrieve the list of files that are in this state, Wwise calls the [AK::Wwise::ISourceControl::GetMissingFilesInDirectories()](class_a_k_1_1_wwise_1_1_i_source_control_acda8ef1d7727c6ba45d302f4c4ee339e.html#acda8ef1d7727c6ba45d302f4c4ee339e) method. The first parameter is the list of directories in which Wwise will look for such missing files, while the second parameter is a list of strings that will be overwritten with the names of the missing files.

|  |  |
| --- | --- |
|  | **警告:** 插件不得包含位于给定目录子目录下的文件。 |

在 Wwise 获得完整文件列表后，Status 和 Owner(s) 列必须刷新。 为此，Wwise 将调用 [AK::Wwise::ISourceControl::GetFileStatus()](class_a_k_1_1_wwise_1_1_i_source_control_ad9ed25401176139c3185a5980b6d44d4.html#ad9ed25401176139c3185a5980b6d44d4) 方法。For each file, the plug-in needs to display the corresponding status and owner of the file. Wwise obtains the status of the files listed in the function's first parameter. The second parameter is the resulting map containing the text to be displayed in the Status and Owner(s) columns.

|  |  |
| --- | --- |
|  | **警告:** The memory of the string members of [AK::Wwise::ISourceControl::FilenameToStatusMapItem](struct_a_k_1_1_wwise_1_1_i_source_control_1_1_filename_to_status_map_item.html) must be allocated using the SysAllocString function because Wwise is responsible for deleting this memory. Two strings must not share the same memory space because Wwise will try to destroy these two strings separately. |

## 在上下文菜单中显示插件

When Wwise displays a contextual menu that includes source control operations, it needs the list of all operations that are available in a specific context. To get this list, Wwise calls the [AK::Wwise::ISourceControl::GetOperationList( OperationMenuType in\_menuType, const StringList& in\_rFilenameList, OperationList& out\_rOperationList )](class_a_k_1_1_wwise_1_1_i_source_control_ad7820c108e50155039c92223eff718f3.html#ad7820c108e50155039c92223eff718f3) method. 第一个参数是显示操作列表的上下文。Depending on this context, some plug-ins could restrict the user to specific operations. The second parameter is the list of file names that the user has selected. This can be used to enable or disable some operations depending on the status of the files. 第三个参数是当前上下文中可用的操作列表。 此操作列表必须由插件生成。The information about the operations contained in this list is used to fill the contextual menu and to call back the plug-in with the ID of the operation. There are no restrictions on either IDs.

Wwise 调用 LPCWSTR GetOperationName( DWORD in\_dwOperationID ) 虚方法来获取操作名称，并在菜单和对话框中显示。

|  |  |
| --- | --- |
|  | **警告:** Wwise 不会删除操作名称字符串占用的内存。We therefore recommend you create static strings that are created and destroyed at the same time as the plug-in instance. |

## 在上下文菜单中显示版本控制操作

When Wwise users choose an operation from a contextual menu, Wwise first calls the [AK::Wwise::ISourceControl::GetOperationEffect( DWORD in\_dwOperationID )](class_a_k_1_1_wwise_1_1_i_source_control_a1cb1c283baf8b61df030a862dd2dc880.html#a1cb1c283baf8b61df030a862dd2dc880 "Gets the operation effect on the file(s) involved in the operation.") method. 其参数是相应操作的 ID。此方法的实现将返回 [AK::Wwise::ISourceControl::OperationEffect](class_a_k_1_1_wwise_1_1_i_source_control_a5a211138d467837ead81bfa7446aa31b.html#a5a211138d467837ead81bfa7446aa31b "The operation's effect on the file(s) involved.") 枚举中一个或多个值所构成的掩码。Wwise 根据返回值获悉，是否必须要求用户先保存工程，然后再继续执行版本控制操作。Update、Rename、Revert 和 Delete 等操作会更改本地文件的内容。Commit 和 Check-in 等操作会修改服务器中文件的内容。

|  |  |
| --- | --- |
|  | **警告:** 音频设计师可能会期望返回相关信息，来明确操作对文件的影响。 版本控制操作期间，当硬盘中的文件发生变化时，Wwise 可以检测到变化并将要求用户重新加载工程。 如果用户有未执行的更改（即工程未清理）并被要求重新加载，他们的更改将丢失。针对对未经清理的文件，如果用户选择 Revert 更改而不重新加载工程，再保存时则可能丢失新的更改。AK::Wwise::ISourceControl::GetOperationEffect 使用返回信息，强制用户进行保存来避免这些情况的发生。 |

After successfully calling the first method, Wwise calls the AK::Wwise::ISourceControl::DoOperation( DWORD in\_dwOperationID, const StringList& in\_rFilenameList ) method. 第一个参数是相应操作的 ID。第二个参数是所选文件的列表。 此方法的实现使用 AK::Wwise::ISourceControlOperationProgress 接口来显示进度对话框。 更多信息请参阅 [实现版本控制操作进度接口](source_control_dll.html#source_control_dll_creation_progress) 。

## 允许 Wwise 刷新 Project Explorer 图标

在下列情况下，Wwise 需要刷新图标：

- 加载了版本控制插件
- 用户接受了插件配置
- The user refreshes the icons manually by clicking on the "Refresh" or "Refresh All" Project Explorer contextual menu item
- 关闭了 File Manager 对话框。

Using a pattern similar to that of the [AK::Wwise::ISourceControl::GetFileStatus()](class_a_k_1_1_wwise_1_1_i_source_control_ad9ed25401176139c3185a5980b6d44d4.html#ad9ed25401176139c3185a5980b6d44d4) method, AK::Wwise::ISourceControl::GetFileStatusIcons( const StringList& in\_rFilenameList, FilenameToIconMap& out\_rFileIconsMap ) must return a map containing icons and tool tip texts for files in the list. The first parameter is the list of names of the file for which Wwise needs to have icon maps. The second parameter is the resulting map containing the following components:

- 显示在工作单元原始图标之上的覆盖图标
- 当鼠标移到该图标上方时显示的工具提示。

|  |  |
| --- | --- |
|  | **警告:** The memory of the string members of [AK::Wwise::ISourceControl::FilenameToIconMapItem](struct_a_k_1_1_wwise_1_1_i_source_control_1_1_filename_to_icon_map_item.html) must be allocated using the SysAllocString function because Wwise is responsible for deleting this memory. Two strings must not share the same memory space because Wwise will try to destroy these two strings separately. |

映射中包含的图标不限大小，但格式必须调整至 15x15 像素。 Functions related to icons are only called if [AK::Wwise::ISourceControl::PluginInfo::m\_bStatusIconAvailable](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info_a4564f014cd3d12853ef34612e237b5a7.html#a4564f014cd3d12853ef34612e237b5a7 "Indicates that the plug-in supports Project Explorer custom icons") is set to True.

|  |  |
| --- | --- |
|  | **技巧:** 随此 SDK 将安装一组您可以使用的图标。 |

## 允许在 Wwise 中创建和修改文件

当 音频设计师执行以下操作时，将进行文件创建和修改操作：

- 创建新的工作单元
- 导入音频源
- 保存工程
- 在外部编辑器中编辑音频源。

When any of these situations arises, Wwise calls the [AK::Wwise::ISourceControl::PreCreateOrModify( const StringList& in\_rFilenameList, CreateOrModifyOperation in\_eOperation, bool& out\_rContinue )](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7) and [AK::Wwise::ISourceControl::PostCreateOrModify( const StringList& in\_rFilenameList, CreateOrModifyOperation in\_eOperation, bool& out\_rContinue )](class_a_k_1_1_wwise_1_1_i_source_control_a9fb467f0d5dbcb386290f53a81bb8dc5.html#a9fb467f0d5dbcb386290f53a81bb8dc5) methods. 第一个参数是要创建或修改的文件名称列表。The second parameter is a flag defining the operation that will be performed. Since you can perform either operation on any of the files listed, you must use the bitwise AND operator to compare the second parameter with a predefined flag. 例如，要想知道是否创建了某些文件，请执行以下操作：

if ( in\_eOperation & CreateOrModifyOperation\_Create )

{

// 执行操作

}

The third parameter of the [AK::Wwise::ISourceControl::PreCreateOrModify()](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7) and [AK::Wwise::ISourceControl::PostCreateOrModify()](class_a_k_1_1_wwise_1_1_i_source_control_a9fb467f0d5dbcb386290f53a81bb8dc5.html#a9fb467f0d5dbcb386290f53a81bb8dc5) functions is set by the plug-in to inform Wwise to continue or stop the current operation. This parameter is mostly used by calls to the [AK::Wwise::ISourceControl::PreCreateOrModify()](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7) method.

|  |  |
| --- | --- |
|  | **技巧:** We recommend that these two methods be used to perform operations that are specific to your source control system. For example, you could use the [AK::Wwise::ISourceControl::PreCreateOrModify()](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7) method to perform Perforce's *checkout* operation, or the [AK::Wwise::ISourceControl::PostCreateOrModify()](class_a_k_1_1_wwise_1_1_i_source_control_a9fb467f0d5dbcb386290f53a81bb8dc5.html#a9fb467f0d5dbcb386290f53a81bb8dc5) method to add files which are not on the server yet. The first method is always called before file creation or modification, and the second one is always called after such an operation. This feature can be used to implement a layer of security in your plug-in. |

# 定义版本控制插件对话框

如果 DLL 包含对话框，您可能希望它们符合 Wwise UI 的外观和风格。To do that, you need to follow the following steps:

- [创建对话框资源](source_control_dll.html#source_control_dll_creation_dialog_creation)
- [启用对话框](source_control_dll.html#source_control_dll_creation_dialog_implement)
- [显示对话框](source_control_dll.html#source_control_dll_creation_dialog_display)

## 创建对话框资源

您可以创建标准的 Windows 控件和 Wwise 专有控件。

### 常规控件

You can add regular controls such as static controls, edit controls, check boxes, push buttons, radio buttons, and group controls directly in the [Microsoft](namespace_microsoft.html) Development Environment Dialog Editor using the corresponding tools in the Dialog Editor section of the Toolbox. These controls will be automatically subclassed by Wwise so they have the same look as similar controls elsewhere in the application.

|  |  |
| --- | --- |
|  | **备注:** 下拉/组合框控件将不会自动细分。If you need a dropdown control in your dialog, use the Combo custom control instead. Refer to Wwise Controls for more information. |

### Wwise 控件

To integrate Wwise dialog controls (such as Captions and ComboBox) into your dialog, use static text control placeholders with a specially-coded caption text. 此文本需符合以下格式：

Class=[Classname];

其中类名称可以是下列之一：

- **Caption:** Read-only text display  
  The static control in your resources should be exactly 13 units high, and wide enough to accommodate the longest text it might contain. To change the text of the caption, you need to use the following standard Windows functions:
  - SetWindowText
  - GetWindowText
- **Combo:** Dropdown list  
  The static control in your resources should be exactly 13 units high, and wide enough to hold the longest text it might contain. To populate the combo box or either set or get its current selection, you must use the following standard Windows message macros:
  - ComboBox\_InsertString
  - ComboBox\_GetCurSel
  - ComboBox\_SetCurSel

|  |  |
| --- | --- |
|  | **技巧:** To make it easier to view the layout of the dialog controls, set Border to True in the properties of the static placeholders in the [Microsoft](namespace_microsoft.html) Development Environment Dialog Editor. |

## 启用对话框

必须先实现 [AK::Wwise::ISourceControlDialogBase](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base.html) 接口，Wwise 才能显示对话框。 此接口提供以下方法：

- [AK::Wwise::ISourceControlDialogBase::GetResourceHandle()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a32a21b3e259526ad996d00ac946ca30f.html#a32a21b3e259526ad996d00ac946ca30f)
- [AK::Wwise::ISourceControlDialogBase::GetDialog()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_ac2e9e65eb75db832fc7ced9a398b1f4c.html#ac2e9e65eb75db832fc7ced9a398b1f4c "This function is called by Wwise to get the plug-in dialog's ID.")
- [AK::Wwise::ISourceControlDialogBase::HasHelp()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a8efe7c9ea503058b2acbf848e680245f.html#a8efe7c9ea503058b2acbf848e680245f)
- [AK::Wwise::ISourceControlDialogBase::Help()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a40fff8f04f4b6532f9a21c1b794a5106.html#a40fff8f04f4b6532f9a21c1b794a5106)
- [AK::Wwise::ISourceControlDialogBase::WindowProc()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_afc8ab1f13cc6f3be3b423bb58597d4e3.html#afc8ab1f13cc6f3be3b423bb58597d4e3)

Wwise 需要知道这些资源能在哪些上下文中找到。Before creating the dialog, Wwise calls the [AK::Wwise::ISourceControlDialogBase::GetResourceHandle()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a32a21b3e259526ad996d00ac946ca30f.html#a32a21b3e259526ad996d00ac946ca30f) method. A typical implementation for this method is:

HINSTANCE DlgSimple::GetResourceHandle() const

{

AFX\_MANAGE\_STATE( ::AfxGetStaticModuleState() );

return ::AfxGetResourceHandle();

}

Wwise 创建对话框时，还需要资源中的对话框 ID 。To retrieve it, Wwise calls the [AK::Wwise::ISourceControlDialogBase::GetDialog()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_ac2e9e65eb75db832fc7ced9a398b1f4c.html#ac2e9e65eb75db832fc7ced9a398b1f4c "This function is called by Wwise to get the plug-in dialog's ID.") method. 此方法的典型实现如下：

void DlgSimple::GetDialog( UINT & out\_uiDialogID ) const

{

out\_uiDialogID = IDD\_SIMPLEDIALOGID;

}

为了获悉是否应在对话框标题栏上显示“?”图标，Wwise 将调用 [AK::Wwise::ISourceControlDialogBase::HasHelp()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a8efe7c9ea503058b2acbf848e680245f.html#a8efe7c9ea503058b2acbf848e680245f)。 如果存在与对话框相关的帮助内容，插件必须返回 True。此时将显示“?”图标。

bool DlgSimple::HasHelp() const

{

return true;

}

When the Wwise user clicks the "?" button of the dialog, Wwise calls the [AK::Wwise::ISourceControlDialogBase::Help()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_a40fff8f04f4b6532f9a21c1b794a5106.html#a40fff8f04f4b6532f9a21c1b794a5106) method. 如果插件处理了帮助请求，则必须返回 True，如果未执行任何操作，则应返回 false。An implementation example of this method is:

bool DlgSimple::Help( HWND in\_hWnd ) const

{

AFX\_MANAGE\_STATE( ::AfxGetStaticModuleState() ) ;

// 注：请勿调用 AfxGetApp()->HtmlHelp()，因为它将从错误的

// 父窗口中启动帮助窗口，导致悬浮窗口

// 行为表现异常。

::HtmlHelp( NULL, AfxGetApp()->m\_pszHelpFilePath, HH\_HELP\_CONTEXT, ONLINEHELP::Simple\_Dialog );

return true;

}

|  |  |
| --- | --- |
|  | **注意:** Help() 方法不应调用 AfxGetApp()->HtmlHelp()。它将从错误的父窗口中启动帮助窗口，导致悬浮窗口行为异常。 应使用带 Null 窗口语柄的 `HtmlHelp()` ，如上文示例中所示。 |

对话框不能使用 MFC 方法管理 Windows 消息。Instead, each time the dialog receives a Windows message, the [AK::Wwise::ISourceControlDialogBase::WindowProc()](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base_afc8ab1f13cc6f3be3b423bb58597d4e3.html#afc8ab1f13cc6f3be3b423bb58597d4e3) is called. An implementation example of this method is:

bool DlgConfiguration::WindowProc( HWND in\_hWnd, UINT in\_message, WPARAM in\_wParam, LPARAM in\_lParam,

LRESULT & out\_lResult )

{

if ( in\_message == WM\_INITDIALOG )

{

// 初始化对话框

}

// 例如：捕获窗口命令动作（仅针对主要对话框）来启用/禁用控件

else if ( in\_message == WM\_COMMAND )

{

// Notification code

switch ( HIWORD( in\_wParam ) )

{

case BN\_CLICKED:

// Check which button was clicked

switch ( LOWORD( in\_wParam ) )

{

case IDOK:

// The user pressed the 'Ok' button

break;

}

} // End switch hi word (notification code)

} // 结束命令窗口事件

// 返回 False，让父窗口处理消息。Return True

// 对于不希望父窗口处理的消息，返回 True。

return false;

}

此方法的返回值含义如下：

- False 表示消息将传给对象的父类。This is the value that is generally returned
- True 表示消息将不会传给对象的父类。Return this value when you do not want the parent to react to the message. For example, when receiving the IDOK button message, the parent generally closes the dialog. In certain circumstances, you might want to let the dialog open if some information has not been completed properly.

要手动关闭对话框，需要使用 Windows PostMessage() 函数。A typical call to this   
function looks like this:

PostMessage( in\_hWnd, WM\_CLOSE, 0, 0 );

## 显示对话框

To display the dialog, an instance of the corresponding [AK::Wwise::ISourceControlDialogBase](class_a_k_1_1_wwise_1_1_i_source_control_dialog_base.html) implementation must be created. Using the [AK::Wwise::ISourceControlUtilities::CreateModalCustomDialog()](class_a_k_1_1_wwise_1_1_i_source_control_utilities_a6e7f5369fce4769309e2ba6fe5ed72d1.html#a6e7f5369fce4769309e2ba6fe5ed72d1) method, the dialog will be displayed like a modal dialog. 如何创建和显示对话框的示例如下：

bool SamplePlugin::ShowConfigDlg()

{

DlgConfiguration configurationDialog( m\_pSourceControlUtilities );

// 如果用户点击“OK”，则返回 true

return m\_pSourceControlUtilities->CreateModalCustomDialog( &configurationDialog ) == IDOK;

}

[AK.Wwise::ISourceControl::GetFileStatusIcons](class_a_k_1_1_wwise_1_1_i_source_control_a177b1676aeffa151c86255a7b747fcdc.html#a177b1676aeffa151c86255a7b747fcdc)

virtual AK::Wwise::ISourceControl::OperationResult GetFileStatusIcons(const StringList &in\_rFilenameList, FilenameToIconMap &out\_rFileIconsMap, DWORD in\_dwTimeoutMs=INFINITE)=0

[AK.Wwise::SourceControlContainers::IAkList](class_a_k_1_1_wwise_1_1_source_control_containers_1_1_i_ak_list.html)

**Definition:** [SourceControlContainers.h:60](_source_control_containers_8h_source.html#l00059)

[AK.Wwise::ISourceControl::GetMissingFilesInDirectories](class_a_k_1_1_wwise_1_1_i_source_control_acda8ef1d7727c6ba45d302f4c4ee339e.html#acda8ef1d7727c6ba45d302f4c4ee339e)

virtual AK::Wwise::ISourceControl::OperationResult GetMissingFilesInDirectories(const StringList &in\_rDirectoryList, StringList &out\_rFilenameList)=0

[AK.Wwise::ISourceControl::GetOperationEffect](class_a_k_1_1_wwise_1_1_i_source_control_a1cb1c283baf8b61df030a862dd2dc880.html#a1cb1c283baf8b61df030a862dd2dc880)

virtual DWORD GetOperationEffect(DWORD in\_dwOperationID)=0

Gets the operation effect on the file(s) involved in the operation.

[AK.Wwise::ISourceControl::Init](class_a_k_1_1_wwise_1_1_i_source_control_a965c84c993e7b9644a7d51dafcdeb113.html#a965c84c993e7b9644a7d51dafcdeb113)

virtual void Init(AK::Wwise::ISourceControlUtilities \*in\_pUtilities, bool in\_bAutoAccept)=0

This function is called when the plug-in is initialized after its creation.

[AK.Wwise::SourceControlContainers::IAkList::AddTail](class_a_k_1_1_wwise_1_1_source_control_containers_1_1_i_ak_list_ad148966a617cb4164a43b3772bb4f321.html#ad148966a617cb4164a43b3772bb4f321)

virtual void AddTail(Arg\_Type in\_newElement)=0

[AK.Wwise::ISourceControl::Destroy](class_a_k_1_1_wwise_1_1_i_source_control_a7682bc6fd40d00c825703604ab79fc85.html#a7682bc6fd40d00c825703604ab79fc85)

virtual void Destroy()=0

This function destroys the plug-in. The implementation is generally '{ delete this; }'.

[AK.Wwise::ISourceControl::GetFileStatus](class_a_k_1_1_wwise_1_1_i_source_control_ad9ed25401176139c3185a5980b6d44d4.html#ad9ed25401176139c3185a5980b6d44d4)

virtual AK::Wwise::ISourceControl::OperationResult GetFileStatus(const StringList &in\_rFilenameList, FilenameToStatusMap &out\_rFileStatusMap, DWORD in\_dwTimeoutMs=INFINITE)=0

[AK::Comm::Init](namespace_a_k_1_1_comm_a596691b552b507c26b4df958ee1c6de8.html#a596691b552b507c26b4df958ee1c6de8)

AKSOUNDENGINE\_API AKRESULT Init(const AkCommSettings &in\_settings)

[AK.Wwise::ISourceControl::DoOperation](class_a_k_1_1_wwise_1_1_i_source_control_a36789a297bc4a85ba0fffb9de9bc0a6f.html#a36789a297bc4a85ba0fffb9de9bc0a6f)

virtual IOperationResult \* DoOperation(DWORD in\_dwOperationID, const StringList &in\_rFilenameList, const StringList \*in\_pTargetFilenameList=NULL)=0

[AK.Wwise::ISourceControl::PreCreateOrModify](class_a_k_1_1_wwise_1_1_i_source_control_aba7d81dda40d38b6c8bb81d190b846f7.html#aba7d81dda40d38b6c8bb81d190b846f7)

virtual AK::Wwise::ISourceControl::OperationResult PreCreateOrModify(const StringList &in\_rFilenameList, CreateOrModifyOperation in\_eOperation, bool &out\_rContinue)=0

[AK.Wwise::Plugin::PluginInfo](namespace_a_k_1_1_wwise_1_1_plugin_a69141ebf4159597c1e76aad07862c823.html#a69141ebf4159597c1e76aad07862c823)

CPluginInfo PluginInfo

**Definition:** [PluginInstanceTypes.h:537](_plugin_instance_types_8h_source.html#l00537)

[AK::Comm::Term](namespace_a_k_1_1_comm_a94e307d2974b89cc4fbc8ab0fef20d2f.html#a94e307d2974b89cc4fbc8ab0fef20d2f)

AKSOUNDENGINE\_API void Term()

[AK.Wwise::ISourceControl::GetOperationName](class_a_k_1_1_wwise_1_1_i_source_control_a817835af7fd2e208f9ba202d6eb5a2eb.html#a817835af7fd2e208f9ba202d6eb5a2eb)

virtual LPCWSTR GetOperationName(DWORD in\_dwOperationID)=0

Gets the operation name to display in user interface

[AK.Wwise::ISourceControlUtilities](class_a_k_1_1_wwise_1_1_i_source_control_utilities.html)

**Definition:** [ISourceControlUtilities.h:49](_i_source_control_utilities_8h_source.html#l00048)

[ISourceControl.h](_i_source_control_8h.html)

[AK.Wwise::SourceControlConstant::s\_dwInvalidOperationID](class_a_k_1_1_wwise_1_1_source_control_constant_ab76ee63c449ed45e8e4f4cdf693dbbb5.html#ab76ee63c449ed45e8e4f4cdf693dbbb5)

static const DWORD s\_dwInvalidOperationID

Invalid operation ID (MUST NOT BE USED as an operation ID in OperationListItem)

**Definition:** [ISourceControl.h:54](_i_source_control_8h_source.html#l00054)

[AK.Wwise::ISourceControl::PostCreateOrModify](class_a_k_1_1_wwise_1_1_i_source_control_a9fb467f0d5dbcb386290f53a81bb8dc5.html#a9fb467f0d5dbcb386290f53a81bb8dc5)

virtual AK::Wwise::ISourceControl::OperationResult PostCreateOrModify(const StringList &in\_rFilenameList, CreateOrModifyOperation in\_eOperation, bool &out\_rContinue)=0

[AK.Wwise::ISourceControl::PluginInfo](class_a_k_1_1_wwise_1_1_i_source_control_1_1_plugin_info.html)

Plug-in information structure. This structure gives a simple overview of the plug-in's capabilities.

**Definition:** [ISourceControl.h:221](_i_source_control_8h_source.html#l00220)

[AK.Wwise::ISourceControl::GetOperationList](class_a_k_1_1_wwise_1_1_i_source_control_ad7820c108e50155039c92223eff718f3.html#ad7820c108e50155039c92223eff718f3)

virtual AK::Wwise::ISourceControl::OperationResult GetOperationList(OperationMenuType in\_menuType, const StringList &in\_rFilenameList, OperationList &out\_rOperationList)=0

[AK.Wwise::ISourceControl](class_a_k_1_1_wwise_1_1_i_source_control.html)

**Definition:** [ISourceControl.h:65](_i_source_control_8h_source.html#l00064)

[AK.Wwise::ISourceControl::Term](class_a_k_1_1_wwise_1_1_i_source_control_a488a4e256024111dc7c3eceef7970b11.html#a488a4e256024111dc7c3eceef7970b11)

virtual void Term()=0

This function is called when the plug-in is terminated before its destruction.

[AK.Wwise::ISourceControl::ShowConfigDlg](class_a_k_1_1_wwise_1_1_i_source_control_a895acce7b436743e5519245529c97ecd.html#a895acce7b436743e5519245529c97ecd)

virtual bool ShowConfigDlg()=0