# 重要的迁移说明 (2012.2)

|  |
| --- |
| Wwise SDK 2025.1.4 - Windows |

重要的迁移说明 (2012.2)

# Environmental system is replaced by the Auxiliary Sends

**Important**: The environmental system was replaced by an auxiliary send system.

Here are the highlights:

**Auxiliary Bus**: The Auxiliary Bus is a new kind of bus that can be inserted anywhere in the Master-Mixer Hierarchy. It contains a subset of the features available on an audio bus, more precisely: audio output volume, effects, states and RTPC.

**Auxiliary Sends**: Any Actor-Mixer Hierarchy or Interactive Music Hierarchy object can define auxiliary sends which allow sending a portion of the audio signal to an auxiliary bus for parallel processing. Environmental effects are now assigned to auxiliary busses and the auxiliary send defines which object reacts to the environmental effects.

**Game-defined Auxiliary Sends:** Up to 4 simultaneous auxiliary sends can be set per game object dynamically in the game. Each send is defined by the auxiliary bus where the information is sent to and a send volume.

**User-defined Auxiliary Sends:** Up to 4 additional sends can be set per Actor-Mixer Hierarchy or Interactive Music Hierarchy object directly in the Authoring tool.

Every object that wants to use the game-defined send system must have the *Use game-defined auxiliary sends* option enabled. Enabling this option is equivalent to route the object to the bus previously identified as environmental.

**Environmental Bus and Effect ShareSets**: The environmental bus concept was removed. During the migration, every effect ShareSet with the *Can be environmental* option set to true will have a matching Auxiliary Bus created under the bus identified as environmental. Those auxiliary busses will host the ShareSet effects, and will be used by the game-defined send system.

**API 变化:**

Please take note of the following API 变化:

- **AK::SoundEngine::SetGameObjectEnvironmentsValues()** becomes **[AK::SoundEngine::SetGameObjectAuxSendValues()](namespace_a_k_1_1_sound_engine_af960fca0239e219b9d08c2659fe9e5d4.html#af960fca0239e219b9d08c2659fe9e5d4)**.  
  Instead of using the SetGameObjectEnvironmentsValues() with shareset IDs, the game can use [SetGameObjectAuxSendValues()](namespace_a_k_1_1_sound_engine_af960fca0239e219b9d08c2659fe9e5d4.html#af960fca0239e219b9d08c2659fe9e5d4) with Auxiliary Bus IDs. The new function allows to set auxiliary sends, per game object, by specifying the send volume and the auxiliary bus.
- **AK::SoundEngine::SetGameObjectDryLevelValue()** becomes **[AK::SoundEngine::SetGameObjectOutputBusVolume()](namespace_a_k_1_1_sound_engine_adf1401ce64872af26cdff05b36e98161.html#adf1401ce64872af26cdff05b36e98161)**.  
  Same behavior as before. Allows to set the main audio output bus volume, per game object, by specifying the direct volume to the bus.
- **AK::SoundEngine::SetEnvironmentVolume()** removed.  
  Use an RTPC on the Auxiliary Bus volume to achieve similar behavior.
- **AK::SoundEngine::SetEnvironmentVolumes()** becomes **AK::SoundEngine::SetAuxBusVolumes()**.  
  Use SetAuxBusVolumes to specify per speaker volumes, for a specified auxiliary bus.
- **AK::SoundEngine::Query::GetEnvironmentVolumes()** becomes **AK::SoundEngine::Query::GetAuxBusVolumes()**.  
  Use GetAuxBusVolumes to obtain the speaker volumes, for a specified auxiliary bus.
- **AK::SoundEngine::BypassEnvironment()** removed.  
  Use an RTPC on the Auxiliary Bus bypass effects property to achieve similar behavior.
- **struct AkEnvironmentValue** becomes **struct [AkAuxSendValue](struct_ak_aux_send_value.html "Auxiliary bus sends information per game object per given auxiliary bus.")**.  
  and members are renamed.
- **struct [AkSpeakerVolumeMatrixCallbackInfo](struct_ak_speaker_volume_matrix_callback_info.html)** member changed.  
  bIsEnvironmental was renamed to bUseWetVolumes.
- **AK\_INVALID\_ENV\_ID** replaced by **AK\_INVALID\_AUX\_ID**
- **AK::SoundEngine::Query::GetGameObjectEnvironmentsValues()** becomes **[AK::SoundEngine::Query::GetGameObjectAuxSendValues()](namespace_a_k_1_1_sound_engine_1_1_query_a4e9c405d1759b2a3546460cfd84e3fae.html#a4e9c405d1759b2a3546460cfd84e3fae)**

**Known Issues**

**Override Parent:** Objects that have a parent routed to the bus previously identified as environmental, but that are not routed to the environmental bus (because of Override Parent), will use the game-defined auxiliary sends after the migration. Please verify if any of these objects exist in your project, and make sure they don't use Game-Defined auxiliary sends in order to maintain the same behavior.

**ShareSet without *Can be Environmental*:** Effect ShareSets that were manually added to a SoundBank and that are used as environmental effects, but with the *Can be environmental* option set to false, won't be migrated to an Auxiliary Bus. Please take some time to identify these ShareSets and create one auxiliary bus for each associated effect, under the bus previously identified as environmental.

**Name conflicts:** When an Auxiliary Bus is automatically created at migration, it is possible that the newly created Auxiliary Bus name do not match the original ShareSet name from which it was created. Please consult the *Project Load Log* after the project is loaded.

# Bus names must be unique

Bus names must now be unique across project. When migrating to 2012.2, busses may be renamed automatically to resolve conflicts.

# API: SetEffect() renamed to SetBusEffect() and SetActorMixerEffect()

SetEffect() was renamed to [SetBusEffect()](namespace_a_k_1_1_sound_engine_aabbeadd26d528e82003a0c143908d825.html#aabbeadd26d528e82003a0c143908d825) and [SetActorMixerEffect()](namespace_a_k_1_1_sound_engine_a00256bfd86c2bed14c626922fc4417b0.html#a00256bfd86c2bed14c626922fc4417b0)

# Volume can go over 0 dB

Volumes are now allowed to go over 0 dB. In previous versions, if RTPC, States or Events in the project were making the volume go over 0 dB, the volume was clipped to 0 dB. With 2012.2, the volume changes are all honored, and the volume could go over 0 dB. This could potentially affect the mix in your game.

# Effect plug-ins need to specify if they use IsSendModeEffect()

When effects are inserted into an Auxiliary Bus, the dry signal may not be part of the output depending if [AK::IAkEffectPluginContext::IsSendModeEffect()](class_a_k_1_1_i_ak_effect_plugin_context_ab8ec44868a3781a40320336c2eedf82e.html#ab8ec44868a3781a40320336c2eedf82e) is returning true or false. It is the responsibility of the effect plug-in to query Wwise with IsSendModeEffect() at run-time initialization to know if it needs to output the dry signal.

When an effect is using the IsSendModeEffect() function, it should specify it inside its XML plug-in definition. The attribute *SupportsIsSendModeEffect* was added to allow the effect plug-ins to specify it. 此属性为可选。

<PluginModule>

<EffectPlugin Name="My Effect" CompanyID="??" PluginID="??" SupportsIsSendModeEffect="true">

...