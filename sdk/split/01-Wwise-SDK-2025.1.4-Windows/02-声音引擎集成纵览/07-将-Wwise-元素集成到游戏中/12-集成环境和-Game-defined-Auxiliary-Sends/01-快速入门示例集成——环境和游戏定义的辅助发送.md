# 快速入门示例集成——环境和游戏定义的辅助发送

|  |
| --- |
| Wwise SDK 2025.1.4 - Windows |

快速入门示例集成——环境和游戏定义的辅助发送

# 环境效果器示例

首先，用户必须在 Wwise 工程中创建代表环境的辅助总线，每个环境对应一条辅助总线。代表此声音的对象属性或者该对象继承的对象属性中必须已经设置了选项“Use game-defined auxiliary sends”。要让游戏使用这些参数集合，声音引擎中必须注册该效果器。注册效果器的方式与注册其它效果器插件的方式（请参见 [插件示例](quickstart_sample_integration_plugins.html#soundengine_integration_effects) 了解更多详情）完全相同，如下例中所示：

#include <[AK/SoundEngine/Common/AkSoundEngine.h](_ak_sound_engine_8h.html)> // 声音引擎

#include <[AK/Plugin/AkRoomVerbFXFactory.h](_ak_room_verb_f_x_factory_8h.html)> // 效果器初始化函数

(...)

AK::InitAkRoomVerbFX([AK::SoundEngine::GetGlobalPluginContext](namespace_a_k_1_1_sound_engine_a3fa34f66e9111147d8c4c0f5ba1f2175.html#a3fa34f66e9111147d8c4c0f5ba1f2175)());

要使初始化函数能够在链接时被找到，您的 C++ 工程必须与相应插件库链接。请参阅 [SDK 中所含库和头文件的概述](libraries.html) 了解有关程序库的更多信息。

// 在此示例中，我们硬编码了 Dry、Hangar 和 Tunnel 的 3 个值。在

// 游戏中，您将根据环境中游戏对象的位置

// 来计算这些值。

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98) nDryRatio = 0.5f;

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98) nHangarRatio = 0.25f;

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98) nTunnelRatio = 0.25f;

[AkAuxSendValue](struct_ak_aux_send_value.html) aEnvs[2];

aEnvs[0].[listenerID](struct_ak_aux_send_value_a185a87e879e5a602446b07252bdd8519.html#a185a87e879e5a602446b07252bdd8519) = [AK\_INVALID\_GAME\_OBJECT](_ak_constants_8h_a82290a98a9cf7901722a69a590aeee34.html#a82290a98a9cf7901722a69a590aeee34); //使用通过 SetListeners/SetDefaultListeners API 指派的同样一组听者。

aEnvs[0].[auxBusID](struct_ak_aux_send_value_a985acf05c92308c7569dd4a91a3e4256.html#a985acf05c92308c7569dd4a91a3e4256) = [AK::SoundEngine::GetIDFromString](namespace_a_k_1_1_sound_engine_a1aae6ebdec25946fb2897ce0e025366d.html#a1aae6ebdec25946fb2897ce0e025366d)( L"Hangar" );

aEnvs[0].[fControlValue](struct_ak_aux_send_value_a1e3fe0e1490d0e15af8a46d8ab4078f4.html#a1e3fe0e1490d0e15af8a46d8ab4078f4) = nHangarRatio;

aEnvs[1].[listenerID](struct_ak_aux_send_value_a185a87e879e5a602446b07252bdd8519.html#a185a87e879e5a602446b07252bdd8519) = [AK\_INVALID\_GAME\_OBJECT](_ak_constants_8h_a82290a98a9cf7901722a69a590aeee34.html#a82290a98a9cf7901722a69a590aeee34); // 使用通过 SetListeners/SetDefaultListeners API 指派的同样一组听者。

aEnvs[1].[auxBusID](struct_ak_aux_send_value_a985acf05c92308c7569dd4a91a3e4256.html#a985acf05c92308c7569dd4a91a3e4256) = [AK::SoundEngine::GetIDFromString](namespace_a_k_1_1_sound_engine_a1aae6ebdec25946fb2897ce0e025366d.html#a1aae6ebdec25946fb2897ce0e025366d)( L"Tunnel" );

aEnvs[1].[fControlValue](struct_ak_aux_send_value_a1e3fe0e1490d0e15af8a46d8ab4078f4.html#a1e3fe0e1490d0e15af8a46d8ab4078f4) = nTunnelRatio;

[AK::SoundEngine::SetGameObjectOutputBusVolume](namespace_a_k_1_1_sound_engine_adf1401ce64872af26cdff05b36e98161.html#adf1401ce64872af26cdff05b36e98161)( GAME\_OBJECT\_ID\_HUMAN, nDryRatio );

[AK::SoundEngine::SetGameObjectAuxSendValues](namespace_a_k_1_1_sound_engine_af960fca0239e219b9d08c2659fe9e5d4.html#af960fca0239e219b9d08c2659fe9e5d4)( GAME\_OBJECT\_ID\_HUMAN, aEnvs, 2 );

请参阅 [集成详情——环境和游戏定义的辅助发送](soundengine_environments.html) 了解这些比例的含义信息。

|  |  |
| --- | --- |
|  | **备注:** 传递给 [AK::SoundEngine::GetIDFromString()](namespace_a_k_1_1_sound_engine_a1aae6ebdec25946fb2897ce0e025366d.html#a1aae6ebdec25946fb2897ce0e025366d) 的名称是 Wwise 中定义的辅助总线的名称。请参阅 [使用 ID 或字符串（Unicode 或 ANSI）](soundengine_environments.html#soundengine_environments_id_vs_string) 了解更多信息。 |

在示例程序中，您可以通过移动“Environments: Footsteps”组中的前三个滑块试验环境效果。通过滑块，您可以为 Dry、Hangar 和 Tunnel 环境设置比例（最左对应 0，最右代表 100）。

请参阅 [集成详情——环境和游戏定义的辅助发送](soundengine_environments.html) 了解更多详情，并参阅 [Integration Demo 示例](soundengine_integration_samplecode.html) 了解工程示例。

# 声障/声笼示例

由于声障（Obstruction）和声笼（Occlusion）取决于环境以及游戏对象和听者的位置，因此可相对于每个听者计算每个游戏对象的声障和声笼。

设置声障和声笼的方式是调用 [AK::SoundEngine::SetObjectObstructionAndOcclusion()](namespace_a_k_1_1_sound_engine_a1b3e18a25b405e55ba82de9b70cd11ba.html#a1b3e18a25b405e55ba82de9b70cd11ba)，如下文中的演示所示：

// 在此示例中，我们硬编码了声障和声笼值。在游戏中，您需要

// 根据游戏对象和听者的位置来以及环境构成

// 来计算这些值。

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98) fObstruction = 0.05f;

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98) fOcclusion = 0.0f;

// 在这种情况下，我们仅计算和设置听者 0 的值。如果您有多个听者，

// 必须单独计算和设置每个听者的这些值。

[AK::SoundEngine::SetObjectObstructionAndOcclusion](namespace_a_k_1_1_sound_engine_a1b3e18a25b405e55ba82de9b70cd11ba.html#a1b3e18a25b405e55ba82de9b70cd11ba)( GAME\_OBJECT\_ID\_HUMAN, 0 /\*listener\*/, fObstruction, fOcclusion );

在示例程序中，您可以通过移动“Environments: Footsteps”组中的最后两个滑块来试验声障和声笼。通过这些滑块，您可以设置声障和声笼的比例（0 到 100）。

请参阅 [声障、声笼及 Game-defined Auxiliary Sends](soundengine_obsocc.html) 了角更多详情，并参阅 [Integration Demo 示例](soundengine_integration_samplecode.html) 了解工程示例。

|  |  |
| --- | --- |
|  | **备注:** 此例程摘自 [示例](samplecode.html) 一节中的“声音引擎集成工程示例”部分。请参阅 [Integration Demo 示例](soundengine_integration_samplecode.html) 了解更多信息。 |

[AkAuxSendValue::fControlValue](struct_ak_aux_send_value_a1e3fe0e1490d0e15af8a46d8ab4078f4.html#a1e3fe0e1490d0e15af8a46d8ab4078f4)

AkReal32 fControlValue

**Definition:** [AkSoundEngineTypes.h:110](_ak_sound_engine_types_8h_source.html#l00110)

[AkSoundEngine.h](_ak_sound_engine_8h.html)

[AkAuxSendValue](struct_ak_aux_send_value.html)

Auxiliary bus sends information per game object per given auxiliary bus.

**Definition:** [AkSoundEngineTypes.h:107](_ak_sound_engine_types_8h_source.html#l00106)

[AK\_INVALID\_GAME\_OBJECT](_ak_constants_8h_a82290a98a9cf7901722a69a590aeee34.html#a82290a98a9cf7901722a69a590aeee34)

static const AkGameObjectID AK\_INVALID\_GAME\_OBJECT

Invalid game object (may also mean all game objects)

**Definition:** [AkConstants.h:33](_ak_constants_8h_source.html#l00033)

[AkReal32](_ak_numeral_types_8h_afc38459f26e2b23defe588026e886a98.html#afc38459f26e2b23defe588026e886a98)

float AkReal32

32-bit floating point

**Definition:** [AkNumeralTypes.h:43](_ak_numeral_types_8h_source.html#l00043)

[AK::SoundEngine::SetObjectObstructionAndOcclusion](namespace_a_k_1_1_sound_engine_a1b3e18a25b405e55ba82de9b70cd11ba.html#a1b3e18a25b405e55ba82de9b70cd11ba)

AKSOUNDENGINE\_API AKRESULT SetObjectObstructionAndOcclusion(AkGameObjectID in\_EmitterID, AkGameObjectID in\_ListenerID, AkReal32 in\_fObstructionLevel, AkReal32 in\_fOcclusionLevel)

[AK::SoundEngine::SetGameObjectAuxSendValues](namespace_a_k_1_1_sound_engine_af960fca0239e219b9d08c2659fe9e5d4.html#af960fca0239e219b9d08c2659fe9e5d4)

AKSOUNDENGINE\_API AKRESULT SetGameObjectAuxSendValues(AkGameObjectID in\_gameObjectID, AkAuxSendValue \*in\_aAuxSendValues, AkUInt32 in\_uNumSendValues)

[AK::SoundEngine::GetIDFromString](namespace_a_k_1_1_sound_engine_a1aae6ebdec25946fb2897ce0e025366d.html#a1aae6ebdec25946fb2897ce0e025366d)

AKSOUNDENGINE\_API AkUInt32 GetIDFromString(const char \*in\_pszString)

[AK::SoundEngine::SetGameObjectOutputBusVolume](namespace_a_k_1_1_sound_engine_adf1401ce64872af26cdff05b36e98161.html#adf1401ce64872af26cdff05b36e98161)

AKSOUNDENGINE\_API AKRESULT SetGameObjectOutputBusVolume(AkGameObjectID in\_emitterObjID, AkGameObjectID in\_listenerObjID, AkReal32 in\_fControlValue)

[AkRoomVerbFXFactory.h](_ak_room_verb_f_x_factory_8h.html)

[AkAuxSendValue::listenerID](struct_ak_aux_send_value_a185a87e879e5a602446b07252bdd8519.html#a185a87e879e5a602446b07252bdd8519)

AkGameObjectID listenerID

Game object ID of the listener associated with this send. Use AK\_INVALID\_GAME\_OBJECT as a wildcard to...

**Definition:** [AkSoundEngineTypes.h:108](_ak_sound_engine_types_8h_source.html#l00108)

[AK::SoundEngine::GetGlobalPluginContext](namespace_a_k_1_1_sound_engine_a3fa34f66e9111147d8c4c0f5ba1f2175.html#a3fa34f66e9111147d8c4c0f5ba1f2175)

AKSOUNDENGINE\_API AK::IAkGlobalPluginContext \* GetGlobalPluginContext()

[AkAuxSendValue::auxBusID](struct_ak_aux_send_value_a985acf05c92308c7569dd4a91a3e4256.html#a985acf05c92308c7569dd4a91a3e4256)

AkAuxBusID auxBusID

Auxiliary bus ID.

**Definition:** [AkSoundEngineTypes.h:109](_ak_sound_engine_types_8h_source.html#l00109)