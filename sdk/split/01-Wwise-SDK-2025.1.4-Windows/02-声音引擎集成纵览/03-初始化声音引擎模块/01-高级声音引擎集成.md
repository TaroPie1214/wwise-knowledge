# 高级声音引擎集成

|  |
| --- |
| Wwise SDK 2025.1.4 - Windows |

高级声音引擎集成

# 声音引擎初始化

|  |  |
| --- | --- |
|  | **备注:** 在初始化声音引擎本身之前，必须首先初始化内存管理器和流管理器。 请参阅 [初始化声音引擎模块](workingwithsdks_initialization.html) 一节了解有关全局初始化的更多信息。 |

初始化声音引擎本身通过调用 [AK::SoundEngine::Init](namespace_a_k_1_1_sound_engine_a9a26da64092b97243844df77cbcdbf5f.html#a9a26da64092b97243844df77cbcdbf5f) 函数来执行。The default initialization shown in [初始化声音引擎](workingwithsdks_initialization.html#initialization_soundengine) is copied here for your convenience.

#include <[AK/SoundEngine/Common/AkSoundEngine.h](_ak_sound_engine_8h.html)> // 声音引擎

(...)

bool InitSoundEngine()

{

(...)

//

// Initialize the sound engine

// Using default initialization parameters

//

if ( [AK::SoundEngine::Init](namespace_a_k_1_1_sound_engine_a9a26da64092b97243844df77cbcdbf5f.html#a9a26da64092b97243844df77cbcdbf5f)( NULL, NULL ) != [AK\_Success](_ak_enums_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63ad7c47fea3da641e7422573c6a13dc35e) )

{

assert( !"Could not initialize the Sound Engine." );

return false;

}

return true;

}

[AK::SoundEngine::Init](namespace_a_k_1_1_sound_engine_a9a26da64092b97243844df77cbcdbf5f.html#a9a26da64092b97243844df77cbcdbf5f) 函数使用 2 个参数。

第一个参数：AkInitSettings \* in\_pSettings

- 此结构包含用于对声音引擎进行初始化的、与平台无关的信息。

第二个参数：AkPlatformInitSettings \* in\_pPlatformSettings

- 此结构包含用于对声音引擎初始化的各平台专用信息。

|  |  |
| --- | --- |
|  | **注意:** 两个参数均可选用。不过，建议最好根据游戏需要自定义这些值，因为有些默认值可能会导致内存用量过高。有关详细信息，请参阅 [固定大小分配](goingfurther_optimizingmempools.html#fixed_allocs) 章节。 |

## 自定义创建参数

[AkInitSettings](struct_ak_init_settings.html) 和 [AkPlatformInitSettings](struct_ak_platform_init_settings.html) 结构必须使用 [AK::SoundEngine::GetDefaultInitSettings](namespace_a_k_1_1_sound_engine_a03381fc17e1b0ee16c2ab501c647ab9e.html#a03381fc17e1b0ee16c2ab501c647ab9e) 和 [AK::SoundEngine::GetDefaultPlatformInitSettings](namespace_a_k_1_1_sound_engine_aecdb9cd8f2d7f461ef1a58f5f5f5725d.html#aecdb9cd8f2d7f461ef1a58f5f5f5725d) 函数初始化。

使用这两个函数对结构进行初始化将在结构中填充默认参数。这一功能非常有用，原因如下：

- 一旦初始化后，就可以轻松地更改参数来满足游戏的需要。
- 使用默认参数可确保代码向下兼容，因为 SDK 的未来版本可能会在结构中添加更多的初始化参数。

以下示例代码展示了如何在自定义单个参数值的情况下使用默认的参数来初始化声音引擎。

#include <[AK/SoundEngine/Common/AkSoundEngine.h](_ak_sound_engine_8h.html)> // 声音引擎

(...)

bool InitSoundEngine()

{

(...)

//

// Create the Sound Engine

// Using modified initialization parameters

//

[AkInitSettings](struct_ak_init_settings.html) initSettings;

[AkPlatformInitSettings](struct_ak_platform_init_settings.html) platformInitSettings;

[AK::SoundEngine::GetDefaultInitSettings](namespace_a_k_1_1_sound_engine_a03381fc17e1b0ee16c2ab501c647ab9e.html#a03381fc17e1b0ee16c2ab501c647ab9e)( initSettings );

[AK::SoundEngine::GetDefaultPlatformInitSettings](namespace_a_k_1_1_sound_engine_aecdb9cd8f2d7f461ef1a58f5f5f5725d.html#aecdb9cd8f2d7f461ef1a58f5f5f5725d)( platformInitSettings );

initSettings.[uMaxNumPaths](struct_ak_init_settings_aa8137dca0d7b55c06900371c17ce6c8e.html#aa8137dca0d7b55c06900371c17ce6c8e) = 16;

if ( [AK::SoundEngine::Init](namespace_a_k_1_1_sound_engine_a9a26da64092b97243844df77cbcdbf5f.html#a9a26da64092b97243844df77cbcdbf5f)( &initSettings, &platformInitSettings ) != [AK\_Success](_ak_enums_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63ad7c47fea3da641e7422573c6a13dc35e) )

{

return false;

}

return true;

}

有关如何调节内存大小的详细信息，请参阅 [固定大小分配](goingfurther_optimizingmempools.html#fixed_allocs) 章节。

[AkSoundEngine.h](_ak_sound_engine_8h.html)

[AK::SoundEngine::Init](namespace_a_k_1_1_sound_engine_a9a26da64092b97243844df77cbcdbf5f.html#a9a26da64092b97243844df77cbcdbf5f)

AKSOUNDENGINE\_API AKRESULT Init(AkInitSettings \*in\_pSettings, AkPlatformInitSettings \*in\_pPlatformSettings)

[AkPlatformInitSettings](struct_ak_platform_init_settings.html)

**Definition:** [AkWinSoundEngine.h:43](_ak_win_sound_engine_8h_source.html#l00042)

[AkInitSettings::uMaxNumPaths](struct_ak_init_settings_aa8137dca0d7b55c06900371c17ce6c8e.html#aa8137dca0d7b55c06900371c17ce6c8e)

AkUInt32 uMaxNumPaths

Maximum number of paths for positioning

**Definition:** [AkSoundEngine.h:196](_ak_sound_engine_8h_source.html#l00196)

[AK::SoundEngine::GetDefaultInitSettings](namespace_a_k_1_1_sound_engine_a03381fc17e1b0ee16c2ab501c647ab9e.html#a03381fc17e1b0ee16c2ab501c647ab9e)

AKSOUNDENGINE\_API void GetDefaultInitSettings(AkInitSettings &out\_settings)

[AK::SoundEngine::GetDefaultPlatformInitSettings](namespace_a_k_1_1_sound_engine_aecdb9cd8f2d7f461ef1a58f5f5f5725d.html#aecdb9cd8f2d7f461ef1a58f5f5f5725d)

AKSOUNDENGINE\_API void GetDefaultPlatformInitSettings(AkPlatformInitSettings &out\_platformSettings)

[AkInitSettings](struct_ak_init_settings.html)

**Definition:** [AkSoundEngine.h:193](_ak_sound_engine_8h_source.html#l00192)

[AK\_Success](_ak_enums_8h_a64f7d1f79613cc4dcc49a4efba6caa63.html#a64f7d1f79613cc4dcc49a4efba6caa63ad7c47fea3da641e7422573c6a13dc35e)

@ AK\_Success

The operation was successful.

**Definition:** [AkEnums.h:34](_ak_enums_8h_source.html#l00034)